
> rest-express@1.0.0 dev
✅ Database: Configuring Supabase connection...
✅ Database: Connection configured (lazy)
[CLICKSIGN V1] 🚀 Initialized in PRODUCTION mode (legal signatures)
[CLICKSIGN V1] API URL: https://app.clicksign.com/api/v1
[CLICKSIGN V1] Token configured: b73b3b90-c87...
[CLICKSIGN] 🔴 Circuit Breaker will be initialized on first use
[INTER] 🏦 Initialized in production mode
[INTER] 🌐 API URL: https://cdpj.partners.bancointer.com.br
[INTER] 🔴 Circuit Breakers will be initialized on first use
[CLICKSIGN V1] 🚀 Initialized in PRODUCTION mode (legal signatures)
[CLICKSIGN V1] API URL: https://app.clicksign.com/api/v1
[CLICKSIGN V1] Token configured: b73b3b90-c...
[DEV QUEUE] 📦 Created development queue: pdf-processing
[DEV QUEUE] 📦 Created development queue: boleto-sync
[DEV QUEUE] 📦 Created development queue: document-processing
[DEV QUEUE] 📦 Created development queue: notifications
[DEV QUEUE] 🚀 Development queues initialized with REAL worker processing
🚀 [TIMING MIDDLEWARE] Creating middleware instance...
🚀 [TIMING MIDDLEWARE] Middleware instance created and exported
12:40:34 AM [express] ✅ All secrets loaded successfully
12:40:34 AM [express] 🔒 [SECURITY] CORS protection configured - ASVS V13.2.1
12:40:34 AM [express] 🔒 [SECURITY] OPTIONS preflight handling configured
12:40:34 AM [express] 🔧 [DEV] Using basic CSP configuration optimized for Vite development
12:40:34 AM [express] 🔒 [SECURITY] Input sanitization middleware activated
12:40:34 AM [express] 🔒 [SECURITY] URL token validation middleware activated - ASVS V7.1.1
12:40:34 AM [express] 🔒 [SECURITY] CSRF protection middleware activated - OWASP Cheat Sheet
12:40:34 AM [express] 🔧 [DEV] Rate limiting configurado para desenvolvimento - limites altos
[SEMGREP MCP] Development mode - using in-memory cache
🧠 [ML] Treinando modelo de detecção...
12:40:34 AM [express] 🔐 Security WebSocket initialized
[CCB SYNC] 🚀 Starting fallback polling (every 6 hours)
[CCB SYNC] ℹ️ Primary processing via webhooks, polling is safety net only
12:40:34 AM [express] 🔄 CCB Sync Service initialized - Webhook primary, polling fallback every 6 hours
12:40:34 AM [express] 🔔 Sistema de Alertas Proativos inicializado - Próxima execução: 20/08/2025, 04:00:00
12:40:34 AM [express] ℹ️  Security monitoring disabled. Set ENABLE_SECURITY_MONITORING=true to enable
12:40:34 AM [express] 🔧 App Config Status:
12:40:34 AM [express]   - Port: 5000
12:40:34 AM [express]   - Environment: development
12:40:34 AM [express]   - Database: ✅ Connected
12:40:34 AM [express]   - Supabase: ✅ Connected
12:40:34 AM [express]   - Security: Rate Limit ✅, Helmet ✅
12:40:34 AM [express] 🚀 Server running on port 5000
12:40:34 AM [express] 🌍 Environment: development
12:40:34 AM [express] 📦 Checking storage buckets...
12:40:35 AM [express] ✅ Storage bucket "documents" already exists as PRIVATE
Browserslist: browsers data (caniuse-lite) is 10 months old. Please run:
  npx update-browserslist-db@latest
  Why you should do it regularly: https://github.com/browserslist/update-db#readme
✅ [ML] Modelo treinado com 0 amostras
✅ Database: Connection test successful
[JWT DEBUG] ==== INÍCIO DA VALIDAÇÃO JWT ====
[JWT DEBUG] Rota acessada: /
[JWT DEBUG] Método: GET
[JWT DEBUG] User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36
[JWT DEBUG] Origin: undefined
[JWT DEBUG] Referer: https://874e2dce-5057-49ae-8fb5-21491c9977ba-00-1xresvzm7is3g.janeway.replit.dev/dashboard
[JWT DEBUG] Header Auth presente: true
[JWT DEBUG] Header começa com Bearer: true
[JWT DEBUG] ==== INÍCIO DA VALIDAÇÃO JWT ====
[JWT DEBUG] Rota acessada: /api/debug/me
[JWT DEBUG] Método: GET
[JWT DEBUG] User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36
[JWT DEBUG] Origin: undefined
[JWT DEBUG] Referer: https://874e2dce-5057-49ae-8fb5-21491c9977ba-00-1xresvzm7is3g.janeway.replit.dev/dashboard
[JWT DEBUG] Header Auth presente: true
[JWT DEBUG] Header começa com Bearer: true
[JWT DEBUG] ==== INÍCIO DA VALIDAÇÃO JWT ====
[JWT DEBUG] Rota acessada: /notificacoes
[JWT DEBUG] Método: GET
[JWT DEBUG] User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36
[JWT DEBUG] Origin: undefined
[JWT DEBUG] Referer: https://874e2dce-5057-49ae-8fb5-21491c9977ba-00-1xresvzm7is3g.janeway.replit.dev/dashboard
[JWT DEBUG] Header Auth presente: true
[JWT DEBUG] Header começa com Bearer: true
🔐 JWT VALIDATION: {
  hasError: false,
  errorType: null,
  hasUser: true,
  userId: 'a65efc54-90cd-4b94-b971-c8a560104032',
  timestamp: '2025-08-20T00:51:56.190Z'
}
🔐 JWT VALIDATION: {
  hasError: false,
  errorType: null,
  hasUser: true,
  userId: 'a65efc54-90cd-4b94-b971-c8a560104032',
  timestamp: '2025-08-20T00:51:56.196Z'
}
🔐 JWT VALIDATION: {
  hasError: false,
  errorType: null,
  hasUser: true,
  userId: 'a65efc54-90cd-4b94-b971-c8a560104032',
  timestamp: '2025-08-20T00:51:56.232Z'
}
Profile query failed: {
  code: 'PGRST116',
  details: 'The result contains 0 rows',
  hint: null,
  message: 'JSON object requested, multiple (or no) rows returned'
}
🚨 [SECURITY] ACCESS_DENIED | severity=HIGH | FAILURE | user=gabrielserri238@gmail.com | ip=177.40.123.110 | endpoint=/api/alertas/notificacoes
Profile query failed: {
  code: 'PGRST116',
  details: 'The result contains 0 rows',
  hint: null,
  message: 'JSON object requested, multiple (or no) rows returned'
}
🚨 [SECURITY] ACCESS_DENIED | severity=HIGH | FAILURE | user=gabrielserri238@gmail.com | ip=177.40.123.110 | endpoint=/api/propostas
Profile query failed: {
  code: 'PGRST116',
  details: 'The result contains 0 rows',
  hint: null,
  message: 'JSON object requested, multiple (or no) rows returned'
}
🚨 [SECURITY] ACCESS_DENIED | severity=HIGH | FAILURE | user=gabrielserri238@gmail.com | ip=177.40.123.110 | endpoint=/api/debug/me
[JWT DEBUG] ==== INÍCIO DA VALIDAÇÃO JWT ====
[JWT DEBUG] Rota acessada: /notificacoes
[JWT DEBUG] Método: GET
[JWT DEBUG] User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36
[JWT DEBUG] Origin: undefined
[JWT DEBUG] Referer: https://874e2dce-5057-49ae-8fb5-21491c9977ba-00-1xresvzm7is3g.janeway.replit.dev/dashboard
[JWT DEBUG] Header Auth presente: true
[JWT DEBUG] Header começa com Bearer: true
[JWT DEBUG] ==== INÍCIO DA VALIDAÇÃO JWT ====
[JWT DEBUG] Rota acessada: /api/debug/me
[JWT DEBUG] Método: GET
[JWT DEBUG] User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36
[JWT DEBUG] Origin: undefined
[JWT DEBUG] Referer: https://874e2dce-5057-49ae-8fb5-21491c9977ba-00-1xresvzm7is3g.janeway.replit.dev/dashboard
[JWT DEBUG] Header Auth presente: true
[JWT DEBUG] Header começa com Bearer: true
[JWT DEBUG] ==== INÍCIO DA VALIDAÇÃO JWT ====
[JWT DEBUG] Rota acessada: /
[JWT DEBUG] Método: GET
[JWT DEBUG] User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36
[JWT DEBUG] Origin: undefined
[JWT DEBUG] Referer: https://874e2dce-5057-49ae-8fb5-21491c9977ba-00-1xresvzm7is3g.janeway.replit.dev/dashboard
[JWT DEBUG] Header Auth presente: true
[JWT DEBUG] Header começa com Bearer: true
🔐 JWT VALIDATION: {
  hasError: false,
  errorType: null,
  hasUser: true,
  userId: 'a65efc54-90cd-4b94-b971-c8a560104032',
  timestamp: '2025-08-20T00:52:06.098Z'
}
🔐 JWT VALIDATION: {
  hasError: false,
  errorType: null,
  hasUser: true,
  userId: 'a65efc54-90cd-4b94-b971-c8a560104032',
  timestamp: '2025-08-20T00:52:06.105Z'
}
🔐 JWT VALIDATION: {
  hasError: false,
  errorType: null,
  hasUser: true,
  userId: 'a65efc54-90cd-4b94-b971-c8a560104032',
  timestamp: '2025-08-20T00:52:06.118Z'
}
Profile query failed: {
  code: 'PGRST116',
  details: 'The result contains 0 rows',
  hint: null,
  message: 'JSON object requested, multiple (or no) rows returned'
}
🚨 [SECURITY] ACCESS_DENIED | severity=HIGH | FAILURE | user=gabrielserri238@gmail.com | ip=177.40.123.110 | endpoint=/api/debug/me
[JWT DEBUG] ==== INÍCIO DA VALIDAÇÃO JWT ====
[JWT DEBUG] Rota acessada: /api/debug/me
[JWT DEBUG] Método: GET
[JWT DEBUG] User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36
[JWT DEBUG] Origin: undefined
[JWT DEBUG] Referer: https://874e2dce-5057-49ae-8fb5-21491c9977ba-00-1xresvzm7is3g.janeway.replit.dev/dashboard
[JWT DEBUG] Header Auth presente: true
[JWT DEBUG] Header começa com Bearer: true
Profile query failed: {
  code: 'PGRST116',
  details: 'The result contains 0 rows',
  hint: null,
  message: 'JSON object requested, multiple (or no) rows returned'
}
🚨 [SECURITY] ACCESS_DENIED | severity=HIGH | FAILURE | user=gabrielserri238@gmail.com | ip=177.40.123.110 | endpoint=/api/propostas
Profile query failed: {
  code: 'PGRST116',
  details: 'The result contains 0 rows',
  hint: null,
  message: 'JSON object requested, multiple (or no) rows returned'
}
🚨 [SECURITY] ACCESS_DENIED | severity=HIGH | FAILURE | user=gabrielserri238@gmail.com | ip=177.40.123.110 | endpoint=/api/alertas/notificacoes
🔐 JWT VALIDATION: {
  hasError: false,
  errorType: null,
  hasUser: true,
  userId: 'a65efc54-90cd-4b94-b971-c8a560104032',
  timestamp: '2025-08-20T00:52:06.936Z'
}
Profile query failed: {
  code: 'PGRST116',
  details: 'The result contains 0 rows',
  hint: null,
  message: 'JSON object requested, multiple (or no) rows returned'
}
🚨 [SECURITY] ACCESS_DENIED | severity=HIGH | FAILURE | user=gabrielserri238@gmail.com | ip=177.40.123.110 | endpoint=/api/debug/me
[JWT DEBUG] ==== INÍCIO DA VALIDAÇÃO JWT ====
[JWT DEBUG] Rota acessada: /notificacoes
[JWT DEBUG] Método: GET
[JWT DEBUG] User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36
[JWT DEBUG] Origin: undefined
[JWT DEBUG] Referer: https://874e2dce-5057-49ae-8fb5-21491c9977ba-00-1xresvzm7is3g.janeway.replit.dev/dashboard
[JWT DEBUG] Header Auth presente: true
[JWT DEBUG] Header começa com Bearer: true
[JWT DEBUG] ==== INÍCIO DA VALIDAÇÃO JWT ====
[JWT DEBUG] Rota acessada: /api/debug/me
[JWT DEBUG] Método: GET
[JWT DEBUG] User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36
[JWT DEBUG] Origin: undefined
[JWT DEBUG] Referer: https://874e2dce-5057-49ae-8fb5-21491c9977ba-00-1xresvzm7is3g.janeway.replit.dev/dashboard
[JWT DEBUG] Header Auth presente: true
[JWT DEBUG] Header começa com Bearer: true
🔐 JWT VALIDATION: {
  hasError: false,
  errorType: null,
  hasUser: true,
  userId: 'a65efc54-90cd-4b94-b971-c8a560104032',
  timestamp: '2025-08-20T00:52:28.396Z'
}
🔐 JWT VALIDATION: {
  hasError: false,
  errorType: null,
  hasUser: true,
  userId: 'a65efc54-90cd-4b94-b971-c8a560104032',
  timestamp: '2025-08-20T00:52:28.461Z'
}
Profile query failed: {
  code: 'PGRST116',
  details: 'The result contains 0 rows',
  hint: null,
  message: 'JSON object requested, multiple (or no) rows returned'
}
🚨 [SECURITY] ACCESS_DENIED | severity=HIGH | FAILURE | user=gabrielserri238@gmail.com | ip=177.40.123.110 | endpoint=/api/debug/me
Profile query failed: {
  code: 'PGRST116',
  details: 'The result contains 0 rows',
  hint: null,
  message: 'JSON object requested, multiple (or no) rows returned'
}
🚨 [SECURITY] ACCESS_DENIED | severity=HIGH | FAILURE | user=gabrielserri238@gmail.com | ip=177.40.123.110 | endpoint=/api/alertas/notificacoes
