PROMPT DE DESENVOLVIMENTO: Atualização Abrangente do Módulo de Cobrança e Otimização de Propostas
1. CONTEXTO E OBJETIVOS
Contexto Atual: O sistema Simpix possui módulos funcionais de Propostas, Pagamentos e Cobranças. No entanto, o módulo de Cobrança necessita de funcionalidades avançadas para gestão proativa de inadimplência, e o fluxo de cadastro de propostas precisa de campos adicionais e validações mais robustas para suportar a operação.

Objetivo Principal: Incrementar o Módulo de Cobrança com ferramentas de gestão de inadimplência, KPIs e integração bancária para renegociação. Simultaneamente, aprimorar a captura de dados na tela de Nova Proposta.

Prioridade: Alta. Essencial para a eficiência operacional da equipe de cobrança.

Restrição Crítica: Todas as funcionalidades existentes DEVEM SER PRESERVADAS. As mudanças devem ser incrementais e não podem quebrar os fluxos atuais de simulação, aprovação ou pagamento. Testes de regressão são obrigatórios.

2. REQUISITOS DETALHADOS
2.1. Módulo de Nova Proposta / Cadastro de Cliente
Este módulo deve ser atualizado para coletar informações mais completas e garantir a qualidade dos dados.

Preenchimento Automático (Auto-fill):

Ao digitar o CPF/CNPJ de um cliente, o sistema deve verificar no database se já existe um cadastro ou proposta anterior para esse documento.

Se existir, preencher automaticamente os campos (Nome, Data de Nascimento, Contato, Endereço).

O usuário deve poder editar os dados preenchidos se necessário.

Validação de Contato (Dependência):

Implementar validação rigorosa no campo de Telefone/Celular para garantir que o número está correto.

Técnico: Utilizar dependências de validação (biblioteca como libphonenumber-js ou similar) para garantir que o número esteja no formato correto (DDD + Número) e seja válido.

Referências Obrigatórias:

Exigir o cadastro de no mínimo 3 referências obrigatórias.

Campos por referência: Nome Completo, Telefone (com validação), Grau de Relacionamento.

Dados Bancários e PIX:

Incluir campos para cadastro de Dados Bancários do cliente (Banco, Agência, Conta).

Incluir um campo específico para "Chave PIX" (com seletor e validação básica do tipo de chave - CPF, Email, Telefone, Aleatória).

Data de Nascimento Obrigatória:

Garantir que o campo "Data de Nascimento" seja obrigatório.

Validar que a data seja válida e, preferencialmente, que o cliente atenda aos critérios de idade (ex: > 18 anos).

Ajuste de Nomenclatura (UI):

Alterar o rótulo (label) de "Data de Carência" para "Data do Primeiro Vencimento" em todas as telas relevantes (Proposta e Simulação).

2.2. API de Simulação (Backend)
Atualização da Tabela Comercial:

Revisar o endpoint da API de simulação.

Garantir que a lógica esteja utilizando e atualizando a "Tabela Comercial" correta e ativa no banco de dados para calcular juros, prazos e valores.

2.3. Módulo de Cobrança (Reformulação Principal)
Este módulo requer a maior parte das atualizações para se tornar uma ferramenta de gestão de inadimplência eficaz e completa.

Gestão de Status e Filtros:

Garantir a atualização automática e precisa dos status das parcelas: Pago, Vencido, A Vencer, e Quitado (para o contrato inteiro).

Manter e otimizar os filtros de atraso existentes: 1-15 dias e 30+ dias.

KPIs de Inadimplência:

Adicionar um dashboard ou painel superior na tela de Cobranças.

Exibir o KPI: "Valor Total de Boletos em Atraso" (Soma de todos os valores vencidos e não pagos).

Ficha do Cliente (Dossiê de Cobrança):

Implementar um botão/link em cada linha da tabela de cobrança para abrir a "Ficha do Cliente".

Esta ficha deve conter:

Informações de Contato: Número de contato, Telefone, Endereço, Referências cadastradas.

Resumo Financeiro: Valor total do contrato, valor em aberto.

Detalhamento de Parcelas: Listagem de parcelas Pagas, Pendentes e Vencidas, com suas respectivas datas de vencimento e pagamento.

Ferramentas de Pagamento: Botão para copiar o Código PIX (Copia e Cola) e a Linha Digitável do boleto da parcela vencida/atual.

Histórico de Observações: (detalhado abaixo).

Sistema de Observações/Histórico de Cobrança:

Na Ficha do Cliente, implementar um campo de texto para adicionar observações sobre o contato.

Exemplos: "Cliente enrolado", "Familiar informou falecimento", "Atitude suspeita", "Previsão de pagamento: DD/MM/AAAA".

Cada observação deve registrar: Usuário que inseriu, Data/Hora e o Texto.

As observações devem ser cumulativas e não editáveis após salvas (formato timeline).

Integração Banco Inter (Renegociação):

Na Ficha do Cliente, para parcelas vencidas, adicionar duas funcionalidades integradas com a API do Banco Inter:

Prorrogação: Opção para prorrogação da data da parcela. Permitir alterar a data de vencimento do boleto (requer chamada à API do Inter para atualizar o boleto existente).

Desconto: Opção de desconto. Permitir aplicar um desconto percentual ou nominal ao valor do boleto (requer chamada à API do Inter para registrar o desconto).

Exportação para Excel (Comunicação Externa):

Adicionar um botão "Exportar Inadimplentes".

Gerar uma planilha Excel (.xlsx) contendo os clientes com parcelas pendentes e atrasadas.

Colunas necessárias para softwares de disparo externo (SMS e WhatsApp): Nome, CPF, Telefone Principal, Email, Data de Vencimento da Parcela Atrasada, Dias em Atraso, Valor Atualizado.

2.4. Controle de Acesso e Gestão (RBAC)
Novo Perfil: "COBRANÇA"

Criar um novo Role/Perfil de usuário no sistema.

Este perfil deve ter acesso apenas ao Módulo de Cobrança.

Restrição de Visão: Este perfil deve visualizar apenas os contratos que possuem parcelas em atraso (Vencido). Eles não devem ver o overview geral que já tem.

3. DESIGN E EXPERIÊNCIA DO USUÁRIO (UX/UI) - QUESTÕES VISUAIS
Tela de Pagamentos (Ajuste Visual):

Revisar o layout da tela de Pagamentos.

Ajustar o design para utilizar um layout baseado em colunas (pode ser um Kanban se houver fluxo de status, ou um Data Grid mais organizado) para melhor visualização e hierarquia da informação.

Tela de Cobranças (Funcionalidade e Clareza):

O design deve ser focado na ação rápida.

Os contratos em maior atraso devem ter destaque visual (ex: indicadores de cor/tags).

A Ficha do Cliente deve ser intuitiva, permitindo que o agente de cobrança encontre rapidamente o telefone, o valor devido e o histórico de conversas sem excesso de rolagem.

Feedback Visual:

Garantir feedback claro ao usuário durante as operações de integração com o Banco Inter (Prorrogação/Desconto), indicando carregamento, sucesso ou falha na atualização do boleto.

4. CRITÉRIOS DE ACEITE
[ ] Clientes recorrentes têm seus dados preenchidos automaticamente ao iniciar uma nova proposta pelo CPF.

[ ] A tela de Nova Proposta não pode ser submetida sem 3 referências, data de nascimento válida e telefone validado via dependência.

[ ] Dados bancários e Chave PIX são coletados na Nova Proposta.

[ ] O termo "Data de Carência" foi substituído por "Data do Primeiro Vencimento".

[ ] A API de simulação reflete os valores da tabela comercial ativa correta.

[ ] O Módulo de Cobrança exibe o KPI de "Valor Total em Atraso" e os filtros de status/aging funcionam corretamente.

[ ] Usuários com perfil "COBRANÇA" só visualizam contratos inadimplentes.

[ ] A Ficha do Cliente centraliza dados de contato, financeiro, histórico de observações e ferramentas de pagamento (Copia e Cola PIX/Boleto).

[ ] É possível adicionar observações datadas e assinadas pelo usuário na ficha do cliente.

[ ] É possível exportar a lista de inadimplentes em Excel com os campos especificados.

[ ] Usuários autorizados conseguem prorrogar ou dar desconto em boletos via integração direta com o Banco Inter pela interface.

[ ] REGRESSÃO ZERO: Nenhuma funcionalidade pré-existente de pagamentos, filtros ou aprovação de crédito foi negativamente afetada.