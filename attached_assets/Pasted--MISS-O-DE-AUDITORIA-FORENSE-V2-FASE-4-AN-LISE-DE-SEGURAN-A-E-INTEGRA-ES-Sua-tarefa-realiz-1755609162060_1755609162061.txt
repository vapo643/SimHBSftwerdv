**MISSÃO DE AUDITORIA FORENSE V2 - FASE 4: ANÁLISE DE SEGURANÇA E INTEGRAÇÕES**

Sua tarefa é realizar uma auditoria de segurança de ponta a ponta, detalhando o fluxo de autenticação, o manuseio de dados sensíveis e as integrações com serviços externos. A resposta DEVE seguir rigorosamente este formato:

**1. Ciclo de Vida do Token (JWT) e Gerenciamento de Sessão:**
   * **Rastreamento Completo:** Descreva o ciclo de vida completo de um token de autenticação, desde o login do usuário até o logout. A descrição deve incluir:
     * **a. Obtenção:** Qual função no frontend é chamada para autenticar o usuário contra a API do Supabase?
     * **b. Armazenamento no Cliente:** Onde e como o JWT retornado é armazenado no navegador (ex: `localStorage`, `sessionStorage`, `httpOnly cookie`)?
     * **c. Contexto (`AuthContext`):** Forneça o código-fonte completo do provedor `AuthContext` para mostrar como o estado do usuário e o token são gerenciados e disponibilizados para os componentes.
     * **d. Utilização (`apiClient`):** Mostre como a instância do `axios` (`apiClient`) é configurada para interceptar requisições e anexar o token JWT no header `Authorization` para chamadas protegidas.
     * **e. Invalidação:** Como o token é removido do cliente durante o processo de logout?

**2. Segurança de Upload de Arquivos (`multer`):**
   * Localize o arquivo de configuração do `multer` no backend.
   * Apresente o código de configuração e explique as medidas de segurança implementadas para o processamento de uploads, especificamente:
     * **Validação de Tipo de Arquivo:** Como o sistema garante que apenas tipos de arquivo permitidos (ex: PDF, JPG) sejam aceitos (verificação de `mimetype`)?
     * **Limite de Tamanho:** Qual é o limite de tamanho (`fileSize`) configurado por arquivo?
     * **Sanitização de Nomes de Arquivo:** Existe alguma lógica para sanitizar os nomes dos arquivos e prevenir ataques de *Directory Traversal*?

**3. Integração de Alta Segurança (Banco Inter com mTLS):**
   * Inspecione os serviços que se comunicam com a API do Banco Inter.
   * Localize e apresente o trecho de código onde as variáveis de ambiente `INTER_CERTIFICATE` e `INTER_PRIVATE_KEY` são utilizadas para configurar o cliente HTTP (`axios` ou `undici`).
   * Explique como essa configuração estabelece uma conexão segura via *Mutual TLS (mTLS)* com os servidores do Banco Inter.

**4. Auditoria de Segurança do Banco de Dados (Row Level Security - RLS):**
   * A arquitetura menciona o uso de RLS. Forneça a prova dessa implementação.
   * Apresente as políticas de RLS (Row Level Security) aplicadas diretamente nas tabelas mais sensíveis do PostgreSQL. Sua resposta deve incluir os comandos SQL exatos (`CREATE POLICY ...`) para as seguintes tabelas:
     * `propostas`
     * `clientes`
     * `contas_bancarias_clientes`