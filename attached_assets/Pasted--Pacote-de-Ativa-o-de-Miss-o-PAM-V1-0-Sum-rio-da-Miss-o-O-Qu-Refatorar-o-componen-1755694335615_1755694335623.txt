### Pacote de Ativação de Missão (PAM) V1.0

* **Sumário da Missão (O Quê):** Refatorar o componente de referências (`PersonalReferencesStep.tsx`) e sua lógica de validação para suportar a adição obrigatória de duas referências: uma pessoal e uma profissional.
* **Intenção Estratégica (O Porquê):** Implementar o requisito de negócio de coleta de referências aprimorada, garantindo que a aplicação capture os dados necessários para uma análise de risco mais completa, conforme solicitado na reunião de requisitos.
* **Histórico Relevante (Consulta Obrigatória):** A FASE 1 (Passo 1.2) do nosso roadmap preparou o banco de dados para esta mudança, alterando a tabela de referências para incluir uma coluna `tipo_referencia`. Esta missão deve agora implementar a UI correspondente.
* **Modelo Mental (Como se Encaixa):** Esta é uma missão de refatoração de UI e lógica de validação. O Agente irá modificar um componente React existente para duplicar um formulário e fortalecer as regras de validação no Zod schema para garantir o preenchimento de ambos.
* **Riscos Antecipados e Contramedidas:**
    * **Risco:** A lógica de estado para gerenciar múltiplos formulários dinâmicos pode se tornar complexa e propensa a bugs.
    * **Contramedida:** O prompt orienta a reutilização do padrão de formulário existente e a centralização da lógica de validação no schema Zod, o que simplifica o estado do componente.

---

**IMPLEMENTAR:**
Atualização do Formulário de Referências Múltiplas

**CURRENT STATE:**
A auditoria confirmou que o componente `PersonalReferencesStep.tsx` e o schema de validação associado foram projetados para capturar apenas uma única referência (pessoal).

**EXPECTED (Estado Final de Sucesso):**
1.  O componente `PersonalReferencesStep.tsx` é modificado para apresentar duas seções de formulário distintas e claramente intituladas: "Referência Pessoal" e "Referência Profissional".
2.  A lógica de estado do componente (`useState` ou `useReducer`) é atualizada para gerenciar um array ou objeto contendo os dados de ambas as referências.
3.  O schema de validação Zod para este passo do formulário é atualizado para exigir o preenchimento obrigatório de ambas as referências (2 no total).
4.  A submissão do formulário envia um array com dois objetos de referência, cada um contendo o `tipo_referencia` correto (`pessoal` ou `profissional`).

**CONSTRAINTS (Roadmap de Implementação):**
1.  **Componente Alvo:** A modificação deve ser focada no arquivo `client/src/components/propostas/PersonalReferencesStep.tsx` e nos schemas Zod relacionados.
2.  **Reutilização de UI:** Reutilize a estrutura JSX do formulário de referência existente. Duplique-a para criar a seção "Referência Profissional".
3.  **Atualização do Schema Zod:** Localize o schema Zod que valida as referências. Modifique-o para esperar um array de referências (`z.array(referenceSchema)`), com uma verificação (`.length(2)`) para garantir que exatamente duas referências sejam fornecidas. Adicione a lógica para diferenciar e validar os tipos "pessoal" e "profissional".
4.  **Lógica de Estado:** Adapte a lógica de estado do componente para manipular um array de referências em vez de um único objeto.

---
**DECLARAÇÃO DE INCERTEZA (OBRIGATÓRIO):**
* **CONFIANÇA NA IMPLEMENTAÇÃO:** [Preencher com a porcentagem de 0 a 100%]
* **RISCOS IDENTIFICADOS:** [Preencher com a categoria BAIXO/MÉDIO/ALTO/CRÍTICO]
* **DECISÕES TÉCNICAS ASSUMIDAS:** [Ex: "Assumi que a melhor forma de gerenciar o estado das duas referências no componente é através de um array."]
* **VALIDAÇÃO PENDENTE:** [A funcionalidade de submissão do formulário com as duas referências deve ser testada de ponta a ponta.]
---

**PROTOCOLO OBRIGATÓRIO 7-CHECK EXPANDIDO:**
1.  Mapear ficheiros e funções exatas afetadas.
2.  Garantir que os schemas Zod e os tipos de dados estão corretos.
3.  Executar `get_latest_lsp_diagnostics` para garantir 0 erros novos.
4.  **Declarar Nível de Confiança (0 a 100%)**.
5.  **Categorizar Riscos Descobertos**.
6.  **Realizar teste funcional completo** (revisão visual do formulário e do código Zod).
7.  **Documentar Decisões Técnicas**.