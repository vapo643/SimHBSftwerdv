### **Pacote de Ativa√ß√£o de Miss√£o (PAM) V2.1 - REM-DDD-01.1 (An√°lise Forense)**

**[DIRETRIZ MESTRA DE DIVULGA√á√ÉO - PDT V2.0 ATIVADA]**
*Sua resposta deve ser exaustiva. Reporte a realidade t√©cnica sem omiss√µes. A transpar√™ncia radical √© mandat√≥ria. Liste todos os trechos de c√≥digo suspeitos, mesmo que a sua confian√ßa seja baixa.*

* **Sum√°rio da Miss√£o (O Qu√™):** Realizar uma auditoria de c√≥digo forense nos arquivos de configura√ß√£o e nos helpers do ambiente de teste para localizar qualquer c√≥digo respons√°vel por executar opera√ß√µes de exclus√£o de dados em massa (ex: `TRUNCATE`, `DROP`, `DELETE FROM ... WHERE 1=1`).
* **Inten√ß√£o Estrat√©gica (O Porqu√™):** Identificar a arma do crime. Precisamos encontrar a fun√ß√£o ou script exato que est√° causando a limpeza do banco de dados para entender a causa raiz do comportamento destrutivo do Agente e, posteriormente, neutraliz√°-lo.
* **Hist√≥rico Relevante (Consulta Obrigat√≥ria):** A √∫ltima grande intera√ß√£o do Agente com o c√≥digo foi na estabiliza√ß√£o dos testes de integra√ß√£o em `tests/integration/unit-of-work.test.ts`. A nossa investiga√ß√£o deve come√ßar nos arquivos que d√£o suporte a esses testes.
* **Modelo Mental (Como se Encaixa):** Voc√™ √© um investigador forense digital (DFIR). Seu trabalho √© procurar por "armas fumegantes" no c√≥digo - fun√ß√µes perigosas, comandos SQL destrutivos, ou configura√ß√µes de ambiente de teste excessivamente permissivas. Documente todas as pistas.
* **Riscos Antecipados e Contramedidas:**
    * **Risco:** **ALTO** - O c√≥digo destrutivo pode n√£o estar em um local √≥bvio, mas sim ser acionado indiretamente por uma cadeia de chamadas.
    * **Contramedida:** A busca n√£o deve se limitar a strings √≥bvias como "TRUNCATE". Procure por padr√µes mais gen√©ricos, como la√ßos que iteram sobre todos os nomes de tabelas (`pg_tables`) e executam uma a√ß√£o de exclus√£o din√¢mica.

---

**IMPLEMENTAR:**
User Story REM-DDD-01.1: Auditoria Forense de Scripts de Teste

**CONTEXT:**
Estamos enfrentando um incidente cr√≠tico de seguran√ßa onde o banco de dados de desenvolvimento est√° sendo completamente apagado. A suspeita principal √© que um script de setup ou teardown no nosso ambiente de testes (Vitest) est√° configurado de forma incorreta e agressiva, causando a destrui√ß√£o dos dados.

**CURRENT STATE:**
O banco de dados est√° sendo esvaziado. A causa √© desconhecida. Os arquivos de configura√ß√£o de teste como `vitest.config.ts`, `tests/setup.ts`, e o helper `tests/lib/db-helper.ts` s√£o os principais suspeitos.

**EXPECTED (Estado Final de Sucesso):**
Voc√™ deve produzir um **Relat√≥rio de An√°lise Forense** contendo:
1.  **C√≥digo Suspeito Identificado:** O trecho de c√≥digo exato, junto com o nome do arquivo e o n√∫mero da linha, que cont√©m a l√≥gica de exclus√£o de dados em massa.
2.  **An√°lise da L√≥gica:** Uma explica√ß√£o detalhada de como e por que esse c√≥digo √© acionado. Ele √© chamado antes de cada teste (`beforeEach`)? Ap√≥s todos os testes (`afterAll`)?
3.  **Lista de Palavras-Chave de Busca:** Para fins de auditoria, liste todas as palavras-chave e padr√µes de busca que voc√™ utilizou para encontrar o c√≥digo suspeito (ex: "TRUNCATE", "DROP TABLE", "DELETE FROM", "pg_tables").

**CONSTRAINTS (Roadmap de Implementa√ß√£o):**
1.  **Busca por Comandos Destrutivos:** Execute uma busca (`rg` ou `grep`) em todo o diret√≥rio `tests/` e `scripts/` pelas seguintes palavras-chave: `TRUNCATE`, `DROP`, `DELETE FROM`. Analise cada resultado.
2.  **An√°lise do Setup Global:** Abra e analise o conte√∫do do arquivo `tests/setup.ts`. Procure por qualquer fun√ß√£o global `beforeAll` ou `afterAll` que interaja com o banco de dados.
3.  **An√°lise do DB Helper:** Abra e analise o conte√∫do do arquivo `tests/lib/db-helper.ts`. Procure por fun√ß√µes de "limpeza" ou "reset" do banco de dados, como `cleanDb()`, `resetDatabase()`, etc.
4.  **An√°lise da Configura√ß√£o do Vitest:** Abra e analise `vitest.config.ts` para ver se ele aponta para algum script de setup global que possa conter a l√≥gica destrutiva.
5.  **Compilar Relat√≥rio:** Organize suas descobertas nas tr√™s se√ß√µes solicitadas no "Estado Final de Sucesso".

---
---
[PGI ATIVO | LEMBRETE DE ESTADO DO ROADMAP]
- **Roadmap em Standby:** "üöÄ ROADMAP MESTRE DE IMPLEMENTA√á√ÉO_ OPERA√á√ÉO A√áO L√çQUIDO.md"
- **Pr√≥ximo Passo a ser Retomado:** Milestone M3: Core Business Logic
- **Miss√£o de Emerg√™ncia Atual:** "An√°lise forense de destrui√ß√£o de dados (REM-DDD-01)"
---