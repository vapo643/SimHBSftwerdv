### **Pacote de Ativação de Missão (PAM) V9.0: Rollout Secundário de Tipagem Canônica (Operação Fênix - P1.8)**

* **Sumário da Missão (O Quê):** Executar a **Fase B.2 (Rollout Secundário)** do plano de remediação `DEBT_REMEDIATION_PLAN.md`. Esta missão consiste em refatorar um lote de **15 controllers** para utilizar o tipo canônico `AuthenticatedRequest`, continuando a eliminação sistemática do débito técnico de tipagem.

* **Intenção Estratégica (O Porquê):** A fase piloto validou a nossa estratégia. Agora, devemos escalar a aplicação da correção para obter um impacto significativo na redução dos erros de compilação. Abordar os controllers em lotes controlados permite um progresso constante e mensurável, sem desestabilizar toda a base de código de uma só vez, seguindo uma abordagem de risco gerenciado.

* **Modelo Mental (Como se Encaixa):** Você continuará a atuar como um **Engenheiro de Refatoração de Precisão**. O padrão de correção foi estabelecido na missão anterior (PAM V8.0): remover a definição de tipo local, importar o tipo canônico de `shared/types/express` (utilizando o path alias `@types/express`) e validar. Sua tarefa é replicar este padrão nos próximos 15 arquivos de maior prioridade.

* **Riscos Antecipados e Contramedidas:**
    * **Risco (ALTO):** **Complexidade Oculta.** Alguns dos controllers neste novo lote podem ter usos mais complexos ou sutis do tipo `AuthenticatedRequest`, onde a substituição direta pode não ser suficiente e pode introduzir falhas de lógica.
    * **Contramedida Mandatória:** A validação final através da suíte de testes (`npm run test`) é a sua rede de segurança. A falha de **qualquer teste** após a refatoração deve ser tratada como uma falha da missão. Você deve reverter **imediatamente** as alterações no arquivo que causou a falha, reportar a anomalia e prosseguir com os arquivos restantes do lote. **NÃO TENTE DEPURAR A FALHA DO TESTE NESTA MISSÃO.**

---

**DIRETRIZ DE MISSÃO: Execução da Fase B.2 do Plano Aprovado**

**CURRENT STATE:**
O sistema está operacional com `2346` erros de TSC. A fase piloto foi bem-sucedida, e 6 das 10 definições duplicadas de `AuthenticatedRequest` ainda precisam ser eliminadas.

**EXPECTED (Estado Final de Sucesso):**
1.  Um lote de 15 arquivos de controller, a serem selecionados com base na maior frequência de erros de tipo, deve ser refatorado para usar o tipo `AuthenticatedRequest` canônico.
2.  A execução de `npx tsc --noEmit` deve resultar em uma redução significativa no número total de erros de tipo (a meta é uma redução de pelo menos 30-50 erros).
3.  A suíte de testes completa (`npm run test`) deve passar sem falhas, confirmando a ausência de regressões funcionais.

**CONSTRAINTS (Protocolo de Execução - Inegociável):**

1.  **Passo 1: Seleção de Alvos.** Execute `npx tsc --noEmit` e, com base na lista de erros, selecione os próximos 15 arquivos de controller (`server/routes/**/*.ts`) que apresentam o erro de tipo `AuthenticatedRequest`. Liste os 15 arquivos selecionados antes de iniciar a refatoração.
2.  **Passo 2: Refatoração em Lote.** Modifique cada um dos 15 arquivos alvo, aplicando o padrão de correção validado: remova a interface local e importe o tipo canônico de `@types/express`.
3.  **Passo 3: Validação da Compilação.** Após refatorar o lote, execute `npx tsc --noEmit`. Capture e reporte o número de erros antes e depois da sua refatoração para medir o progresso.
4.  **Passo 4: Validação Funcional.** Execute a suíte de testes completa com `npm run test`. Se algum teste falhar, reverta as alterações no arquivo causador, documente a falha e continue.
5.  **Passo 5: Relatório Final.** Reporte a conclusão da missão, apresentando o `diff` das alterações bem-sucedidas, a redução final no número de erros de `tsc`, e a saída bem-sucedida da execução dos testes.

---

**DECLARAÇÃO DE INCERTEZA (OBRIGATÓRIO):**

* **CONFIANÇA NA IMPLEMENTAÇÃO:** 80%
* **RISCOS IDENTIFICADOS:** ALTO (O risco de introduzir regressões funcionais aumenta com o número de arquivos modificados).
* **DECISÕES TÉCNICAS ASSUMIDAS:** Assumo que o padrão de erro nos próximos 15 arquivos é idêntico ao do lote piloto.
* **VALIDAÇÃO PENDENTE:** A passagem da suíte de testes completa e a redução verificável de erros de `tsc` serão a prova final da missão.

---

**PROTOCOLO OBRIGATÓRIO 7-CHECK (ADAPTATIVO - Nível FULL):**
Ao concluir esta missão de execução, você **DEVE** executar e reportar o resultado do `7-CHECK FULL`, pois o risco foi classificado como **ALTO**.