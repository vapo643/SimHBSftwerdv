### **Pacote de Ativação de Missão (PAM) V1.0 - P0.1: Unificação de Pipeline**

* **Sumário da Missão (O Quê):** Executar uma unificação temporária e emergencial do fluxo de criação de propostas, desabilitando o pipeline DDD defeituoso e forçando todo o tráfego através do pipeline Legacy, que, apesar de inconsistente, é o mais estável no momento.
* **Intenção Estratégica (O Porquê):** Esta é a Ação P0.1 da "Operação Aço Líquido". A coexistência de dois pipelines de criação incompatíveis (`Legacy` e `DDD`) é a causa primária do "Dual Controller Chaos" e do "Cisma de Dados" identificados nos diagnósticos. Ao centralizar o fluxo de criação, eliminamos a aleatoriedade e garantimos que 100% das novas propostas sejam criadas de forma consistente, mesmo que temporariamente sub-ótima. Isto é um pré-requisito para estabilizar o sistema.
* **Histórico Relevante (Consulta Obrigatória):** A decisão de executar esta ação baseia-se diretamente na análise da Fase P0 do `ROADMAP_MESTRE_ACO_LIQUIDO.md`, que por sua vez se baseia nas auditorias que identificaram a "Esquizofrenia Arquitetural".
* **Modelo Mental (Como se Encaixa):** Estamos a atuar como engenheiros de controle de tráfego na camada de roteamento da API. Estamos a colocar um desvio claro e inequívoco, garantindo que todas as requisições `POST /api/propostas` sigam para um único destino (`server/routes/propostas/core.ts`), enquanto o caminho que leva à falha (`proposalController.ts` do DDD) é temporariamente bloqueado.
* **Riscos Antecipados e Contramedidas:**
    * **Risco:** O pipeline Legacy pode ter outras falhas não relacionadas com o contrato de dados.
    * **Contramedida:** O roadmap prevê esta situação. A Ação P0.3 ("Implementação de Adaptador de Contrato API") irá blindar o frontend contra estas inconsistências. O nosso foco aqui é apenas no controle de fluxo.

---

**IMPLEMENTAR:** Unificação Temporária do Fluxo de Criação de Propostas

**CONTEXT:** Atualmente, duas rotas e dois controllers (`Legacy` e `DDD`) competem para gerir a criação de novas propostas, causando inconsistência e falhas sistémicas. Precisamos de estabilizar o sistema forçando todas as criações através de um único pipeline.

**CURRENT STATE:** O sistema está a operar com dois pipelines de criação ativos e conflitantes, conforme identificado no `ROADMAP_MESTRE_ACO_LIQUIDO.md`.

**EXPECTED (Estado Final de Sucesso):**
1.  A rota `POST /` no arquivo `server/routes/propostas/core.ts` (Legacy) deve estar confirmada como o único ponto de entrada para a criação de propostas.
2.  Qualquer outra rota de criação de proposta, especificamente a que é gerida pelo `proposalController.ts` do módulo DDD, deve ser desativada para impedir a sua execução.
3.  O sistema deve permanecer compilável e funcional após a alteração, com um único fluxo de criação de propostas.

**CONSTRAINTS (Roadmap de Implementação):**

1.  **Auditoria de Confirmação (Ponto de Partida):**
    * Abra `server/routes/propostas/core.ts`. Verifique e confirme a existência da rota de criação Legacy (ex: `router.post('/', ...)`).
    * Abra `server/modules/proposal/presentation/proposalController.ts`. Localize o método `create` e a rota associada a ele.

2.  **Execução (Controle de Fluxo):**
    * No arquivo do controller DDD, `server/modules/proposal/presentation/proposalController.ts`, localize a rota que aponta para o método `create`. **Comente** esta linha de código para desativá-la. Não a apague. Adicione um comentário de aviso.
        * **Exemplo:**
            ```typescript
            // Rota de criação DDD temporariamente desativada - OPERAÇÃO AÇO LÍQUIDO P0.1
            // router.post('/', auth, (req, res) => this.create(req, res));
            ```

3.  **Validação:**
    * Execute o protocolo `7-CHECK`. A execução de `get_latest_lsp_diagnostics` é **obrigatória** e não deve retornar novos erros críticos. O seu relatório deve confirmar que o pipeline DDD de criação está inativo e que o pipeline Legacy é agora o único ponto de entrada.

---
**DECLARAÇÃO DE INCERTEZA (OBRIGATÓRIO):**
* **CONFIANÇA NA IMPLEMENTAÇÃO:** \[Preencher com a porcentagem de 0 a 100%]
* **RISCOS IDENTIFICADOS:** \[Preencher com a categoria BAIXO/MÉDIO/ALTO/CRÍTICO e uma breve descrição]
* **DECISÕES TÉCNICAS ASSUMIDAS:** \[Ex: "Assumi que comentar a rota no controller DDD é a forma mais segura e reversível de desativar o pipeline."]
* **VALIDAÇÃO PENDENTE:** \[Ex: "Validação funcional completa do fluxo de criação legacy será necessária após a Fase P0 estar completa."]

---
**PROTOCOLO OBRIGATÓRIO 7-CHECK EXPANDIDO:**
1.  Mapear ficheiros e funções exatas afetadas.
2.  Garantir importações e tipos corretos.
3.  Executar `get_latest_lsp_diagnostics` e corrigir TODOS os erros.
4.  Declarar Nível de Confiança (0-100%) na implementação.
5.  Categorizar Riscos Descobertos (BAIXO/MÉDIO/ALTO/CRÍTICO).
6.  Realizar teste funcional (será feito no final da Fase P0).
7.  Documentar Decisões Técnicas assumidas para auditoria futura.