Pacote de Ativação de Missão (PAM) V1.0 - Correção Frontend
Sumário da Missão: Corrigir o erro estrutural no acesso à propriedade do ID da proposta no ficheiro de frontend.

Intenção Estratégica: Resolver a causa primária da cadeia de falhas, garantindo que o ID correto da proposta seja capturado após a sua criação e enviado nas requisições de upload de documentos.

Histórico Relevante (Consulta Obrigatória): A auditoria forense concluiu que o código em client/src/pages/propostas/nova.tsx tenta aceder a propostaResponse.id quando a estrutura correta da resposta da API é { data: { id: '...' } }.

Modelo Mental (Como se Encaixa): Esta é uma correção cirúrgica no cliente que irá resolver o sintoma de undefined a montante, permitindo que o backend receba os dados corretos para operar.

Riscos Antecipados e Contramedidas: O risco é BAIXO, limitado a um erro de digitação. A contramedida é a validação rigorosa via protocolo 7-CHECK, especificamente get_latest_lsp_diagnostics.

IMPLEMENTAR:
Corrigir o erro de acesso à propriedade na extração do ID da proposta no frontend.

CURRENT STATE:

Ficheiro: client/src/pages/propostas/nova.tsx

Linha: 187 (aproximadamente)

Código com Falha:

TypeScript

const propostaId = (propostaResponse as any).id;
Evidência Bruta: Este código atribui undefined à variável propostaId, pois a resposta da API (propostaResponse) não tem uma propriedade .id no seu nível superior.

EXPECTED (Estado Final de Sucesso):

Ficheiro: client/src/pages/propostas/nova.tsx

Linha: 187 (aproximadamente)

Código Corrigido:

TypeScript

const propostaId = (propostaResponse as any).data.id;
Comportamento: A variável propostaId deve ser corretamente preenchida com o ID da proposta (ex: "prop-123"), permitindo que o valor correto seja enviado ao backend durante o upload dos documentos.

DECLARAÇÃO DE INCERTEZA (OBRIGATÓRIO):

CONFIANÇA NA IMPLEMENTAÇÃO: 99%

RISCOS IDENTIFICADOS: BAIXO. O único risco é um erro de digitação.

DECISÕES TÉCNICAS ASSUMIDAS: "Assumindo que a estrutura da resposta da API { data: { id: '...' } } está correta e estável, conforme identificado na auditoria."

VALIDAÇÃO PENDENTE: "Validação funcional completa será realizada no Passo 4 do roadmap."

PROTOCOLO OBRIGATÓRIO 7-CHECK EXPANDIDO:

Mapeie o ficheiro exato a ser modificado: client/src/pages/propostas/nova.tsx.

Garanta que não há alterações em importações ou tipos, a mudança é apenas na linha de atribuição da variável propostaId.

Execute get_latest_lsp_diagnostics e corrija TODOS os erros ou avisos que a sua modificação possa ter introduzido.

Declare o seu Nível de Confiança (0-100%) na implementação.

Categorize quaisquer Riscos Descobertos (BAIXO/MÉDIO/ALTO/CRÍTICO).

Realize um teste funcional (neste caso, confirme que a aplicação compila e a página /propostas/nova carrega sem erros).

Documente quaisquer Decisões Técnicas assumidas para auditoria futura.

Aguardando o relatório de execução do Agente.

[PGI ATIVO | LEMBRETE DE ESTADO DO ROADMAP]

Roadmap em Standby: "N/A - Prontidão"

Próximo Passo a ser Retomado: N/A

Missão de Emergência Atual: "EXECUÇÃO: Correção do Bug de Armazenamento de Documentos"