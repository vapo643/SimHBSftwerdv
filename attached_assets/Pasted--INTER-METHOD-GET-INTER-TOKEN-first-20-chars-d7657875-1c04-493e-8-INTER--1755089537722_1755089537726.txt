[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:50:57 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-15506210fe1b3b420082220dbbb89041-9c030e1b940c03d4-01',
  'x-envoy-upstream-service-time': '80',
  'x-rate-limit-remaining': '116',
  'x-rate-limit-time': '1755089475498',
  'x-upstream-time': '83'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "210074a3-e28a-41a5-807a-ee3981ff0d15",
    "seuNumero": "SX80841-17",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-01-04",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348105",
    "codigoBarras": "07791168100000833330001112134234790398348105",
    "linhaDigitavel": "07790001161213423479303983481056116810000083333"
  },
  "pix": {
    "txid": "34647053617550090810009O7EI88ErASSU",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/5cd2ba29faaf4ca4b190a10f4fa9774a5204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***63042A0B"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983481056116810000083333
[INTER] 📊 Código de barras: 07791168100000833330001112134234790398348105
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/210074a3-e28a-41a5-807a-ee3981ff0d15/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 400 Bad Request
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '293',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:50:57 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-d57976239880b751e03fee330f208704-2f4d5a46e8bac312-00',
  'x-envoy-upstream-service-time': '4',
  'x-rate-limit-remaining': '117',
  'x-rate-limit-time': '1755089476315',
  'x-upstream-time': '7'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 293 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 400
[INTER] 🚨 Error Body: "{"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:50:57.31091162-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}"
[INTER] 🚨 Error Body Length: 287 chars
[INTER] 📋 Error as JSON: {
  "title": "Dados inválidos.",
  "detail": "Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.",
  "timestamp": "2025-08-13T09:50:57.31091162-03:00",
  "violacoes": [
    {
      "razao": "Não foi possível converter o valor.",
      "propriedade": "codigoSolicitacao"
    }
  ]
}
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Failed to retrieve collection: Error: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:50:57.31091162-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
    at IncomingMessage.<anonymous> (/home/runner/workspace/server/services/interBankService.ts:551:17)
    at IncomingMessage.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
[INTER] ❌ Erro ao obter PDF: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:50:57.31091162-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
[INTER] 🔄 Tentando endpoints alternativos...
[INTER] 🔄 Testando endpoints alternativos para PDF...
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/pdf/download
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/pdf/download
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:50:57 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-17/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-17/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 17: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 17
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: 210074a3-e28a-41a5-807a-ee3981ff0d15
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: 210074a3-e28a-41a5-807a-ee3981ff0d15
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/210074a3-e28a-41a5-807a-ee3981ff0d15
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-17/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-17/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-17/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-17/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/pdf/download: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/pdf/download falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/arquivo
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/arquivo
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:50:57 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-87a111512573e94047a48aaad3d9bcaf-013b8f5c20fe6ca4-00',
  'x-envoy-upstream-service-time': '79',
  'x-rate-limit-remaining': '115',
  'x-rate-limit-time': '1755089475498',
  'x-upstream-time': '85'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "210074a3-e28a-41a5-807a-ee3981ff0d15",
    "seuNumero": "SX80841-17",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-01-04",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348105",
    "codigoBarras": "07791168100000833330001112134234790398348105",
    "linhaDigitavel": "07790001161213423479303983481056116810000083333"
  },
  "pix": {
    "txid": "34647053617550090810009O7EI88ErASSU",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/5cd2ba29faaf4ca4b190a10f4fa9774a5204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***63042A0B"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983481056116810000083333
[INTER] 📊 Código de barras: 07791168100000833330001112134234790398348105
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/210074a3-e28a-41a5-807a-ee3981ff0d15/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:50:57 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-0985c267c64f3454b4f86ad367f1f273-9de71bb3052ef751-00',
  'x-envoy-upstream-service-time': '126',
  'x-rate-limit-remaining': '116',
  'x-rate-limit-time': '1755089475768',
  'x-upstream-time': '129',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:50:57 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-f0344f5e4f12fc12e5e0d91e2808ba09-d66a57c669ce81b7-00',
  'x-envoy-upstream-service-time': '84',
  'x-rate-limit-remaining': '115',
  'x-rate-limit-time': '1755089475768',
  'x-upstream-time': '87',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 55246 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55236 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55236 caracteres
[INTER] ✅ PDF convertido: 41427 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41427 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43373 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 17 adicionada
[SECURE_CONTAINER] 📄 Baixando parcela 18
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: CORRETO-1755013508.325368-18
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: CORRETO-1755013508.325368-18
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-18
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:50:57 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-17/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-17/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 17: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 17
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: 210074a3-e28a-41a5-807a-ee3981ff0d15
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: 210074a3-e28a-41a5-807a-ee3981ff0d15
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/210074a3-e28a-41a5-807a-ee3981ff0d15
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/arquivo: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/arquivo falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/documento
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/documento
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 400 Bad Request
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '294',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:50:57 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-1a3795f564e065d86eca847003db040f-f747f14593d81dab-00',
  'x-envoy-upstream-service-time': '5',
  'x-rate-limit-remaining': '116',
  'x-rate-limit-time': '1755089476315',
  'x-upstream-time': '7'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 294 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 400
[INTER] 🚨 Error Body: "{"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:50:57.965707785-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}"
[INTER] 🚨 Error Body Length: 288 chars
[INTER] 📋 Error as JSON: {
  "title": "Dados inválidos.",
  "detail": "Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.",
  "timestamp": "2025-08-13T09:50:57.965707785-03:00",
  "violacoes": [
    {
      "razao": "Não foi possível converter o valor.",
      "propriedade": "codigoSolicitacao"
    }
  ]
}
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Failed to retrieve collection: Error: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:50:57.965707785-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
    at IncomingMessage.<anonymous> (/home/runner/workspace/server/services/interBankService.ts:551:17)
    at IncomingMessage.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
[INTER] ❌ Erro ao obter PDF: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:50:57.965707785-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
[INTER] 🔄 Tentando endpoints alternativos...
[INTER] 🔄 Testando endpoints alternativos para PDF...
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/pdf/download
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/pdf/download
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] 📦 Response buffer size: 55246 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55236 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55236 caracteres
[INTER] ✅ PDF convertido: 41427 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41427 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43372 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 17 adicionada
[SECURE_CONTAINER] 📄 Baixando parcela 18
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: CORRETO-1755013508.325368-18
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: CORRETO-1755013508.325368-18
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-18
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/pdf/download: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/pdf/download falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/arquivo
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/arquivo
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:50:58 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-15a21d2b6fa188e0912264f664c09751-9056c32627e4b023-00',
  'x-envoy-upstream-service-time': '119',
  'x-rate-limit-remaining': '114',
  'x-rate-limit-time': '1755089475498',
  'x-upstream-time': '147'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "210074a3-e28a-41a5-807a-ee3981ff0d15",
    "seuNumero": "SX80841-17",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-01-04",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348105",
    "codigoBarras": "07791168100000833330001112134234790398348105",
    "linhaDigitavel": "07790001161213423479303983481056116810000083333"
  },
  "pix": {
    "txid": "34647053617550090810009O7EI88ErASSU",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/5cd2ba29faaf4ca4b190a10f4fa9774a5204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***63042A0B"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983481056116810000083333
[INTER] 📊 Código de barras: 07791168100000833330001112134234790398348105
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/210074a3-e28a-41a5-807a-ee3981ff0d15/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 400 Bad Request
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '294',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:50:58 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-9a11244675100a85e502daccfbbdc38a-830cd0cc46e21530-00',
  'x-envoy-upstream-service-time': '4',
  'x-rate-limit-remaining': '115',
  'x-rate-limit-time': '1755089476315',
  'x-upstream-time': '7'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 294 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 400
[INTER] 🚨 Error Body: "{"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:50:58.199514329-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}"
[INTER] 🚨 Error Body Length: 288 chars
[INTER] 📋 Error as JSON: {
  "title": "Dados inválidos.",
  "detail": "Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.",
  "timestamp": "2025-08-13T09:50:58.199514329-03:00",
  "violacoes": [
    {
      "razao": "Não foi possível converter o valor.",
      "propriedade": "codigoSolicitacao"
    }
  ]
}
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Failed to retrieve collection: Error: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:50:58.199514329-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
    at IncomingMessage.<anonymous> (/home/runner/workspace/server/services/interBankService.ts:551:17)
    at IncomingMessage.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
[INTER] ❌ Erro ao obter PDF: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:50:58.199514329-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
[INTER] 🔄 Tentando endpoints alternativos...
[INTER] 🔄 Testando endpoints alternativos para PDF...
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/pdf/download
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/pdf/download
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/pdf/download: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/pdf/download falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/arquivo
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/arquivo
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-18/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-18/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:50:58 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-28df5187f17cb6ed909c899744906ff4-a6e6f1941a612dbc-00',
  'x-envoy-upstream-service-time': '108',
  'x-rate-limit-remaining': '114',
  'x-rate-limit-time': '1755089475768',
  'x-upstream-time': '111',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/arquivo: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/arquivo falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/documento
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/documento
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] 📦 Response buffer size: 55246 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55236 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55236 caracteres
[INTER] ✅ PDF convertido: 41427 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41427 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43371 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 17 adicionada
[SECURE_CONTAINER] 📄 Baixando parcela 18
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: CORRETO-1755013508.325368-18
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: CORRETO-1755013508.325368-18
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-18
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 400 Bad Request
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '291',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:50:58 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-ba8000754a375f2b28d4885f38c40807-a4c541c3ef3dbf49-00',
  'x-envoy-upstream-service-time': '13',
  'x-rate-limit-remaining': '114',
  'x-rate-limit-time': '1755089476315',
  'x-upstream-time': '31'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 291 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 400
[INTER] 🚨 Error Body: "{"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:50:58.839184-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}"
[INTER] 🚨 Error Body Length: 285 chars
[INTER] 📋 Error as JSON: {
  "title": "Dados inválidos.",
  "detail": "Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.",
  "timestamp": "2025-08-13T09:50:58.839184-03:00",
  "violacoes": [
    {
      "razao": "Não foi possível converter o valor.",
      "propriedade": "codigoSolicitacao"
    }
  ]
}
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Failed to retrieve collection: Error: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:50:58.839184-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
    at IncomingMessage.<anonymous> (/home/runner/workspace/server/services/interBankService.ts:551:17)
    at IncomingMessage.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
[INTER] ❌ Erro ao obter PDF: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:50:58.839184-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
[INTER] 🔄 Tentando endpoints alternativos...
[INTER] 🔄 Testando endpoints alternativos para PDF...
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/pdf/download
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/pdf/download
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/arquivo: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/arquivo falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/documento
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/documento
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:50:58 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-18/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-18/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 18: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 18
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: 7438d333-e4f2-49cd-a3fc-9b66a7baaa1b
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: 7438d333-e4f2-49cd-a3fc-9b66a7baaa1b
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/7438d333-e4f2-49cd-a3fc-9b66a7baaa1b
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/pdf/download: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/pdf/download falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/arquivo
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/arquivo
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:50:59 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-e6f830243c652148f9f9f13f675b8bb8-dc4c11cd41ba8556-00',
  'x-envoy-upstream-service-time': '79',
  'x-rate-limit-remaining': '117',
  'x-rate-limit-time': '1755089478189',
  'x-upstream-time': '82'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "7438d333-e4f2-49cd-a3fc-9b66a7baaa1b",
    "seuNumero": "SX81761-18",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-02-03",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348147",
    "codigoBarras": "07797171100000833330001112134234790398348147",
    "linhaDigitavel": "07790001161213423479303983481478717110000083333"
  },
  "pix": {
    "txid": "3464705361755009081000tGmSSJQogEjHy",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/01adcac10fe94b54a9ad9b36d03a42365204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***63042692"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983481478717110000083333
[INTER] 📊 Código de barras: 07797171100000833330001112134234790398348147
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/7438d333-e4f2-49cd-a3fc-9b66a7baaa1b/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-18/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-18/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:50:59 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-6e58c68e177338d766e9c5147de18c0a-13a370a7b89d6ce8-00',
  'x-envoy-upstream-service-time': '94',
  'x-rate-limit-remaining': '117',
  'x-rate-limit-time': '1755089478399',
  'x-upstream-time': '98',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-18/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-18/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/arquivo: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/arquivo falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/documento
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/documento
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] 📦 Response buffer size: 55318 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55308 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55308 caracteres
[INTER] ✅ PDF convertido: 41480 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41480 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43426 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 18 adicionada
[SECURE_CONTAINER] 📄 Baixando parcela 19
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: CORRETO-1755013508.325368-19
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: CORRETO-1755013508.325368-19
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-19
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:50:59 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-18/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-18/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 18: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 18
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: 7438d333-e4f2-49cd-a3fc-9b66a7baaa1b
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: 7438d333-e4f2-49cd-a3fc-9b66a7baaa1b
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/7438d333-e4f2-49cd-a3fc-9b66a7baaa1b
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 400 Bad Request
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '293',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:50:59 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-8020145a881183b7289b0b9bc70e3bca-a3ae7b4220e53132-00',
  'x-envoy-upstream-service-time': '3',
  'x-rate-limit-remaining': '117',
  'x-rate-limit-time': '1755089478922',
  'x-upstream-time': '5'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 293 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 400
[INTER] 🚨 Error Body: "{"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:50:59.76143561-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}"
[INTER] 🚨 Error Body Length: 287 chars
[INTER] 📋 Error as JSON: {
  "title": "Dados inválidos.",
  "detail": "Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.",
  "timestamp": "2025-08-13T09:50:59.76143561-03:00",
  "violacoes": [
    {
      "razao": "Não foi possível converter o valor.",
      "propriedade": "codigoSolicitacao"
    }
  ]
}
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Failed to retrieve collection: Error: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:50:59.76143561-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
    at IncomingMessage.<anonymous> (/home/runner/workspace/server/services/interBankService.ts:551:17)
    at IncomingMessage.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
[INTER] ❌ Erro ao obter PDF: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:50:59.76143561-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
[INTER] 🔄 Tentando endpoints alternativos...
[INTER] 🔄 Testando endpoints alternativos para PDF...
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/pdf/download
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/pdf/download
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/pdf/download: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/pdf/download falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/arquivo
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/arquivo
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:50:59 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-5f65dfb941d8920755874b100909cff8-995eb57ce9d83ce9-00',
  'x-envoy-upstream-service-time': '100',
  'x-rate-limit-remaining': '116',
  'x-rate-limit-time': '1755089478189',
  'x-upstream-time': '104'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "7438d333-e4f2-49cd-a3fc-9b66a7baaa1b",
    "seuNumero": "SX81761-18",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-02-03",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348147",
    "codigoBarras": "07797171100000833330001112134234790398348147",
    "linhaDigitavel": "07790001161213423479303983481478717110000083333"
  },
  "pix": {
    "txid": "3464705361755009081000tGmSSJQogEjHy",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/01adcac10fe94b54a9ad9b36d03a42365204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***63042692"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983481478717110000083333
[INTER] 📊 Código de barras: 07797171100000833330001112134234790398348147
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/7438d333-e4f2-49cd-a3fc-9b66a7baaa1b/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:50:59 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-18/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-18/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 18: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 18
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: 7438d333-e4f2-49cd-a3fc-9b66a7baaa1b
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: 7438d333-e4f2-49cd-a3fc-9b66a7baaa1b
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/7438d333-e4f2-49cd-a3fc-9b66a7baaa1b
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-18/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-18/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-18/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:00 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-9412d01bef6eb390d1cd040def080518-020c56615228d7e2-00',
  'x-envoy-upstream-service-time': '78',
  'x-rate-limit-remaining': '115',
  'x-rate-limit-time': '1755089478189',
  'x-upstream-time': '80'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "7438d333-e4f2-49cd-a3fc-9b66a7baaa1b",
    "seuNumero": "SX81761-18",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-02-03",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348147",
    "codigoBarras": "07797171100000833330001112134234790398348147",
    "linhaDigitavel": "07790001161213423479303983481478717110000083333"
  },
  "pix": {
    "txid": "3464705361755009081000tGmSSJQogEjHy",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/01adcac10fe94b54a9ad9b36d03a42365204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***63042692"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983481478717110000083333
[INTER] 📊 Código de barras: 07797171100000833330001112134234790398348147
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/7438d333-e4f2-49cd-a3fc-9b66a7baaa1b/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:00 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-85d2a360761a9d0183959c7048f6fc16-aa3a6bd4a2a88346-00',
  'x-envoy-upstream-service-time': '120',
  'x-rate-limit-remaining': '116',
  'x-rate-limit-time': '1755089478399',
  'x-upstream-time': '124',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:00 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-3c9ff36fc30b82d0c4f272f70b57b929-e5685001296a895c-00',
  'x-envoy-upstream-service-time': '74',
  'x-rate-limit-remaining': '115',
  'x-rate-limit-time': '1755089478399',
  'x-upstream-time': '77',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/arquivo: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/arquivo falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/documento
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/documento
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] 📦 Response buffer size: 55318 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55308 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55308 caracteres
[INTER] ✅ PDF convertido: 41480 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41480 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43425 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 18 adicionada
[SECURE_CONTAINER] 📄 Baixando parcela 19
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: CORRETO-1755013508.325368-19
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: CORRETO-1755013508.325368-19
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-19
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:51:00 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-18/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-18/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 18: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 18
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: 7438d333-e4f2-49cd-a3fc-9b66a7baaa1b
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: 7438d333-e4f2-49cd-a3fc-9b66a7baaa1b
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/7438d333-e4f2-49cd-a3fc-9b66a7baaa1b
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 400 Bad Request
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '294',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:00 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-83c7eddbe6606102651ec648367fff24-9b8da3205816a566-00',
  'x-envoy-upstream-service-time': '6',
  'x-rate-limit-remaining': '116',
  'x-rate-limit-time': '1755089478922',
  'x-upstream-time': '8'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 294 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 400
[INTER] 🚨 Error Body: "{"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:00.589478867-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}"
[INTER] 🚨 Error Body Length: 288 chars
[INTER] 📋 Error as JSON: {
  "title": "Dados inválidos.",
  "detail": "Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.",
  "timestamp": "2025-08-13T09:51:00.589478867-03:00",
  "violacoes": [
    {
      "razao": "Não foi possível converter o valor.",
      "propriedade": "codigoSolicitacao"
    }
  ]
}
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Failed to retrieve collection: Error: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:00.589478867-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
    at IncomingMessage.<anonymous> (/home/runner/workspace/server/services/interBankService.ts:551:17)
    at IncomingMessage.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
[INTER] ❌ Erro ao obter PDF: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:00.589478867-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
[INTER] 🔄 Tentando endpoints alternativos...
[INTER] 🔄 Testando endpoints alternativos para PDF...
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/pdf/download
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/pdf/download
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] 📦 Response buffer size: 55318 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55308 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55308 caracteres
[INTER] ✅ PDF convertido: 41480 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41480 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43421 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 18 adicionada
[SECURE_CONTAINER] 📄 Baixando parcela 19
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: CORRETO-1755013508.325368-19
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: CORRETO-1755013508.325368-19
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-19
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/pdf/download: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/pdf/download falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/arquivo
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/arquivo
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 400 Bad Request
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '294',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:00 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-26d462a3d35a5b6985b88015ff49e579-f9b1e46d2b7893bb-00',
  'x-envoy-upstream-service-time': '6',
  'x-rate-limit-remaining': '115',
  'x-rate-limit-time': '1755089478922',
  'x-upstream-time': '11'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 294 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 400
[INTER] 🚨 Error Body: "{"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:00.772237743-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}"
[INTER] 🚨 Error Body Length: 288 chars
[INTER] 📋 Error as JSON: {
  "title": "Dados inválidos.",
  "detail": "Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.",
  "timestamp": "2025-08-13T09:51:00.772237743-03:00",
  "violacoes": [
    {
      "razao": "Não foi possível converter o valor.",
      "propriedade": "codigoSolicitacao"
    }
  ]
}
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Failed to retrieve collection: Error: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:00.772237743-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
    at IncomingMessage.<anonymous> (/home/runner/workspace/server/services/interBankService.ts:551:17)
    at IncomingMessage.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
[INTER] ❌ Erro ao obter PDF: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:00.772237743-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
[INTER] 🔄 Tentando endpoints alternativos...
[INTER] 🔄 Testando endpoints alternativos para PDF...
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/pdf/download
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/pdf/download
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:00 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-76afa15e30716308c134f5f9864503b8-c44b7615bc797d39-00',
  'x-envoy-upstream-service-time': '88',
  'x-rate-limit-remaining': '114',
  'x-rate-limit-time': '1755089478189',
  'x-upstream-time': '110'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "7438d333-e4f2-49cd-a3fc-9b66a7baaa1b",
    "seuNumero": "SX81761-18",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-02-03",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348147",
    "codigoBarras": "07797171100000833330001112134234790398348147",
    "linhaDigitavel": "07790001161213423479303983481478717110000083333"
  },
  "pix": {
    "txid": "3464705361755009081000tGmSSJQogEjHy",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/01adcac10fe94b54a9ad9b36d03a42365204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***63042692"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983481478717110000083333
[INTER] 📊 Código de barras: 07797171100000833330001112134234790398348147
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/7438d333-e4f2-49cd-a3fc-9b66a7baaa1b/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/pdf/download: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/pdf/download falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/arquivo
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/arquivo
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-19/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-19/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:01 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-5d1c5b40ff7e35dcbb3a05cdb827899f-57b6caaab0bd7b92-00',
  'x-envoy-upstream-service-time': '72',
  'x-rate-limit-remaining': '114',
  'x-rate-limit-time': '1755089478399',
  'x-upstream-time': '76',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/arquivo: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/arquivo falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/documento
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/documento
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] 📦 Response buffer size: 55318 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55308 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55308 caracteres
[INTER] ✅ PDF convertido: 41480 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41480 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43419 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 18 adicionada
[SECURE_CONTAINER] 📄 Baixando parcela 19
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: CORRETO-1755013508.325368-19
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: CORRETO-1755013508.325368-19
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-19
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 400 Bad Request
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '294',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:01 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-d7e516279cf9a316d6a588b65928e437-5c8eb9a0925f8bcc-00',
  'x-envoy-upstream-service-time': '6',
  'x-rate-limit-remaining': '114',
  'x-rate-limit-time': '1755089478922',
  'x-upstream-time': '10'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 294 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 400
[INTER] 🚨 Error Body: "{"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:01.416047078-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}"
[INTER] 🚨 Error Body Length: 288 chars
[INTER] 📋 Error as JSON: {
  "title": "Dados inválidos.",
  "detail": "Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.",
  "timestamp": "2025-08-13T09:51:01.416047078-03:00",
  "violacoes": [
    {
      "razao": "Não foi possível converter o valor.",
      "propriedade": "codigoSolicitacao"
    }
  ]
}
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Failed to retrieve collection: Error: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:01.416047078-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
    at IncomingMessage.<anonymous> (/home/runner/workspace/server/services/interBankService.ts:551:17)
    at IncomingMessage.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
[INTER] ❌ Erro ao obter PDF: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:01.416047078-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
[INTER] 🔄 Tentando endpoints alternativos...
[INTER] 🔄 Testando endpoints alternativos para PDF...
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/pdf/download
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/pdf/download
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/arquivo: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/arquivo falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/documento
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/documento
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:51:01 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-19/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-19/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 19: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 19
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: d5422afd-a164-4331-b5ff-29fe9ce758ee
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: d5422afd-a164-4331-b5ff-29fe9ce758ee
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/d5422afd-a164-4331-b5ff-29fe9ce758ee
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/pdf/download: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/pdf/download falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/arquivo
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/arquivo
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:01 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-fdff8e6e8ded92e21f17469680323d83-da56f8eb3c6eccd5-00',
  'x-envoy-upstream-service-time': '74',
  'x-rate-limit-remaining': '117',
  'x-rate-limit-time': '1755089480757',
  'x-upstream-time': '75'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "d5422afd-a164-4331-b5ff-29fe9ce758ee",
    "seuNumero": "SX82642-19",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-03-05",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348154",
    "codigoBarras": "07793174100000833330001112134234790398348154",
    "linhaDigitavel": "07790001161213423479303983481544317410000083333"
  },
  "pix": {
    "txid": "3464705361755009082000utjLo8NkdTxqj",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/bc83327b5dc5499c825a1a044fe501925204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***63042F04"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983481544317410000083333
[INTER] 📊 Código de barras: 07793174100000833330001112134234790398348154
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/d5422afd-a164-4331-b5ff-29fe9ce758ee/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-19/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-19/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:01 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-a485ec3cd49160994a3c40e83d9dccbe-69881596228e0370-00',
  'x-envoy-upstream-service-time': '118',
  'x-rate-limit-remaining': '117',
  'x-rate-limit-time': '1755089480964',
  'x-upstream-time': '120',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-19/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-19/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/arquivo: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/arquivo falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/documento
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/documento
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] 📦 Response buffer size: 55234 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55224 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55224 caracteres
[INTER] ✅ PDF convertido: 41416 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41416 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43362 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 19 adicionada
[SECURE_CONTAINER] 📄 Baixando parcela 20
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: 214dc1d5-59c2-4497-a3ed-b421989ef167
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: 214dc1d5-59c2-4497-a3ed-b421989ef167
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/214dc1d5-59c2-4497-a3ed-b421989ef167
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:51:02 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-19/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-19/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 19: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 19
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: d5422afd-a164-4331-b5ff-29fe9ce758ee
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: d5422afd-a164-4331-b5ff-29fe9ce758ee
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/d5422afd-a164-4331-b5ff-29fe9ce758ee
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:02 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-a129e322bca53a2ec19a0094de1cfec4-5f33f65a7984a9be-00',
  'x-envoy-upstream-service-time': '89',
  'x-rate-limit-remaining': '116',
  'x-rate-limit-time': '1755089463549',
  'x-upstream-time': '90'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "214dc1d5-59c2-4497-a3ed-b421989ef167",
    "seuNumero": "SX83548-20",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-04-04",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348188",
    "codigoBarras": "07791177100000833330001112134234790398348188",
    "linhaDigitavel": "07790001161213423479303983481882117710000083333"
  },
  "pix": {
    "txid": "3464705361755009083000nMnoM02ud7zIy",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/b5a9497249954363b2e5d5e4db5c4c055204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***63043DF4"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983481882117710000083333
[INTER] 📊 Código de barras: 07791177100000833330001112134234790398348188
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/214dc1d5-59c2-4497-a3ed-b421989ef167/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:51:02 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-19/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-19/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 19: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 19
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: d5422afd-a164-4331-b5ff-29fe9ce758ee
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: d5422afd-a164-4331-b5ff-29fe9ce758ee
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/d5422afd-a164-4331-b5ff-29fe9ce758ee
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:02 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-8efef4f5cdb169c69d9cb5fb41a937d4-26b57b0a4e4f0d7f-00',
  'x-envoy-upstream-service-time': '53',
  'x-rate-limit-remaining': '116',
  'x-rate-limit-time': '1755089480757',
  'x-upstream-time': '77'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "d5422afd-a164-4331-b5ff-29fe9ce758ee",
    "seuNumero": "SX82642-19",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-03-05",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348154",
    "codigoBarras": "07793174100000833330001112134234790398348154",
    "linhaDigitavel": "07790001161213423479303983481544317410000083333"
  },
  "pix": {
    "txid": "3464705361755009082000utjLo8NkdTxqj",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/bc83327b5dc5499c825a1a044fe501925204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***63042F04"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983481544317410000083333
[INTER] 📊 Código de barras: 07793174100000833330001112134234790398348154
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/d5422afd-a164-4331-b5ff-29fe9ce758ee/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-19/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-19/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-19/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:02 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-2c73169fe22c6af4296d402065628733-1b9d4da77ca227bb-00',
  'x-envoy-upstream-service-time': '100',
  'x-rate-limit-remaining': '116',
  'x-rate-limit-time': '1755089463894',
  'x-upstream-time': '122',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 55462 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55452 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55452 caracteres
[INTER] ✅ PDF convertido: 41589 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41589 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43529 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 20 adicionada
[SECURE_CONTAINER] 📄 Baixando parcela 20
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: CORRETO-1755013508.325368-20
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: CORRETO-1755013508.325368-20
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-20
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:02 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-464af660509957cb7c132bdf3d5689e4-33f3c13f811d3dd0-00',
  'x-envoy-upstream-service-time': '70',
  'x-rate-limit-remaining': '115',
  'x-rate-limit-time': '1755089480757',
  'x-upstream-time': '72'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "d5422afd-a164-4331-b5ff-29fe9ce758ee",
    "seuNumero": "SX82642-19",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-03-05",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348154",
    "codigoBarras": "07793174100000833330001112134234790398348154",
    "linhaDigitavel": "07790001161213423479303983481544317410000083333"
  },
  "pix": {
    "txid": "3464705361755009082000utjLo8NkdTxqj",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/bc83327b5dc5499c825a1a044fe501925204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***63042F04"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983481544317410000083333
[INTER] 📊 Código de barras: 07793174100000833330001112134234790398348154
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/d5422afd-a164-4331-b5ff-29fe9ce758ee/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:02 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-ba9bc0cbd6b2cc99efdb3072fa07a8be-88378c901673c446-00',
  'x-envoy-upstream-service-time': '97',
  'x-rate-limit-remaining': '116',
  'x-rate-limit-time': '1755089480964',
  'x-upstream-time': '111',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 400 Bad Request
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '294',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:02 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-2ef9cd6c7a55806746b4d677ce6a455c-9a3ad5aac9d5e8aa-00',
  'x-envoy-upstream-service-time': '5',
  'x-rate-limit-remaining': '117',
  'x-rate-limit-time': '1755089481923',
  'x-upstream-time': '8'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 294 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 400
[INTER] 🚨 Error Body: "{"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:02.808577425-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}"
[INTER] 🚨 Error Body Length: 288 chars
[INTER] 📋 Error as JSON: {
  "title": "Dados inválidos.",
  "detail": "Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.",
  "timestamp": "2025-08-13T09:51:02.808577425-03:00",
  "violacoes": [
    {
      "razao": "Não foi possível converter o valor.",
      "propriedade": "codigoSolicitacao"
    }
  ]
}
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Failed to retrieve collection: Error: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:02.808577425-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
    at IncomingMessage.<anonymous> (/home/runner/workspace/server/services/interBankService.ts:551:17)
    at IncomingMessage.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
[INTER] ❌ Erro ao obter PDF: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:02.808577425-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
[INTER] 🔄 Tentando endpoints alternativos...
[INTER] 🔄 Testando endpoints alternativos para PDF...
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/pdf/download
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/pdf/download
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/pdf/download: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/pdf/download falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/arquivo
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/arquivo
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:02 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-fdce8c4872483a4ce69bae139ec49f12-eb891d751e33907d-00',
  'x-envoy-upstream-service-time': '136',
  'x-rate-limit-remaining': '115',
  'x-rate-limit-time': '1755089480964',
  'x-upstream-time': '140',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:51:02 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-19/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-19/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 19: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 19
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: d5422afd-a164-4331-b5ff-29fe9ce758ee
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: d5422afd-a164-4331-b5ff-29fe9ce758ee
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/d5422afd-a164-4331-b5ff-29fe9ce758ee
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] 📦 Response buffer size: 55234 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55224 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55224 caracteres
[INTER] ✅ PDF convertido: 41416 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41416 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43364 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 19 adicionada
[SECURE_CONTAINER] 📄 Baixando parcela 20
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: 214dc1d5-59c2-4497-a3ed-b421989ef167
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: 214dc1d5-59c2-4497-a3ed-b421989ef167
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/214dc1d5-59c2-4497-a3ed-b421989ef167
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:03 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-ea9cc69b56baf49936e9f129a36b4bc1-150399e3fb35c864-00',
  'x-envoy-upstream-service-time': '68',
  'x-rate-limit-remaining': '114',
  'x-rate-limit-time': '1755089480757',
  'x-upstream-time': '70'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "d5422afd-a164-4331-b5ff-29fe9ce758ee",
    "seuNumero": "SX82642-19",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-03-05",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348154",
    "codigoBarras": "07793174100000833330001112134234790398348154",
    "linhaDigitavel": "07790001161213423479303983481544317410000083333"
  },
  "pix": {
    "txid": "3464705361755009082000utjLo8NkdTxqj",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/bc83327b5dc5499c825a1a044fe501925204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***63042F04"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983481544317410000083333
[INTER] 📊 Código de barras: 07793174100000833330001112134234790398348154
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/d5422afd-a164-4331-b5ff-29fe9ce758ee/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] 📦 Response buffer size: 55234 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55224 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55224 caracteres
[INTER] ✅ PDF convertido: 41416 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41416 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43367 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 19 adicionada
[SECURE_CONTAINER] 📄 Baixando parcela 20
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: 214dc1d5-59c2-4497-a3ed-b421989ef167
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: 214dc1d5-59c2-4497-a3ed-b421989ef167
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/214dc1d5-59c2-4497-a3ed-b421989ef167
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:03 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-6c124c6f56bb521c4dfa2c0bafa44747-b0d2c10f9eb2c638-00',
  'x-envoy-upstream-service-time': '60',
  'x-rate-limit-remaining': '115',
  'x-rate-limit-time': '1755089463549',
  'x-upstream-time': '63'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "214dc1d5-59c2-4497-a3ed-b421989ef167",
    "seuNumero": "SX83548-20",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-04-04",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348188",
    "codigoBarras": "07791177100000833330001112134234790398348188",
    "linhaDigitavel": "07790001161213423479303983481882117710000083333"
  },
  "pix": {
    "txid": "3464705361755009083000nMnoM02ud7zIy",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/b5a9497249954363b2e5d5e4db5c4c055204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***63043DF4"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983481882117710000083333
[INTER] 📊 Código de barras: 07791177100000833330001112134234790398348188
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/214dc1d5-59c2-4497-a3ed-b421989ef167/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/arquivo: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/arquivo falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/documento
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/documento
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:03 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-c638fded3efe25c3ca77d3dfc221b082-aa63822cf957c545-00',
  'x-envoy-upstream-service-time': '76',
  'x-rate-limit-remaining': '114',
  'x-rate-limit-time': '1755089480964',
  'x-upstream-time': '80',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:03 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-e3b26263338f382741141f4dc46d430e-9715551d41fcc444-00',
  'x-envoy-upstream-service-time': '69',
  'x-rate-limit-remaining': '114',
  'x-rate-limit-time': '1755089463549',
  'x-upstream-time': '71'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "214dc1d5-59c2-4497-a3ed-b421989ef167",
    "seuNumero": "SX83548-20",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-04-04",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348188",
    "codigoBarras": "07791177100000833330001112134234790398348188",
    "linhaDigitavel": "07790001161213423479303983481882117710000083333"
  },
  "pix": {
    "txid": "3464705361755009083000nMnoM02ud7zIy",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/b5a9497249954363b2e5d5e4db5c4c055204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***63043DF4"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983481882117710000083333
[INTER] 📊 Código de barras: 07791177100000833330001112134234790398348188
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/214dc1d5-59c2-4497-a3ed-b421989ef167/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:03 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-4d46b226b0a5bb9d4171c9aa54a937fa-4daa9b1e36fa8f14-00',
  'x-envoy-upstream-service-time': '89',
  'x-rate-limit-remaining': '115',
  'x-rate-limit-time': '1755089463894',
  'x-upstream-time': '93',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 55462 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55452 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55452 caracteres
[INTER] ✅ PDF convertido: 41589 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41589 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43532 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 20 adicionada
[SECURE_CONTAINER] 📄 Baixando parcela 20
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: CORRETO-1755013508.325368-20
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: CORRETO-1755013508.325368-20
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-20
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:03 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-cdc371943de5f4e565ce6b107f4dfefb-cbd580545d093ae3-00',
  'x-envoy-upstream-service-time': '74',
  'x-rate-limit-remaining': '114',
  'x-rate-limit-time': '1755089463894',
  'x-upstream-time': '76',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 55462 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55452 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55452 caracteres
[INTER] ✅ PDF convertido: 41589 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41589 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43535 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 20 adicionada
[SECURE_CONTAINER] 📄 Baixando parcela 20
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: CORRETO-1755013508.325368-20
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: CORRETO-1755013508.325368-20
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-20
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 400 Bad Request
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '294',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:03 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-7b8e8a0e8a9e0522f18d195ace9c254d-c16cd4acb2c47630-00',
  'x-envoy-upstream-service-time': '4',
  'x-rate-limit-remaining': '116',
  'x-rate-limit-time': '1755089481923',
  'x-upstream-time': '32'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 294 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 400
[INTER] 🚨 Error Body: "{"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:03.637460318-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}"
[INTER] 🚨 Error Body Length: 288 chars
[INTER] 📋 Error as JSON: {
  "title": "Dados inválidos.",
  "detail": "Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.",
  "timestamp": "2025-08-13T09:51:03.637460318-03:00",
  "violacoes": [
    {
      "razao": "Não foi possível converter o valor.",
      "propriedade": "codigoSolicitacao"
    }
  ]
}
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Failed to retrieve collection: Error: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:03.637460318-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
    at IncomingMessage.<anonymous> (/home/runner/workspace/server/services/interBankService.ts:551:17)
    at IncomingMessage.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
[INTER] ❌ Erro ao obter PDF: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:03.637460318-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
[INTER] 🔄 Tentando endpoints alternativos...
[INTER] 🔄 Testando endpoints alternativos para PDF...
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/pdf/download
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/pdf/download
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] 📦 Response buffer size: 55234 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55224 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55224 caracteres
[INTER] ✅ PDF convertido: 41416 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41416 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43355 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 19 adicionada
[SECURE_CONTAINER] 📄 Baixando parcela 20
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: 214dc1d5-59c2-4497-a3ed-b421989ef167
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: 214dc1d5-59c2-4497-a3ed-b421989ef167
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/214dc1d5-59c2-4497-a3ed-b421989ef167
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/pdf/download: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/pdf/download falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/arquivo
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/arquivo
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 400 Bad Request
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '293',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:03 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-7178978f80e29a39e70816f5b90aa90b-64e7268d99bceff9-00',
  'x-envoy-upstream-service-time': '5',
  'x-rate-limit-remaining': '115',
  'x-rate-limit-time': '1755089481923',
  'x-upstream-time': '12'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 293 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 400
[INTER] 🚨 Error Body: "{"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:03.77847361-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}"
[INTER] 🚨 Error Body Length: 287 chars
[INTER] 📋 Error as JSON: {
  "title": "Dados inválidos.",
  "detail": "Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.",
  "timestamp": "2025-08-13T09:51:03.77847361-03:00",
  "violacoes": [
    {
      "razao": "Não foi possível converter o valor.",
      "propriedade": "codigoSolicitacao"
    }
  ]
}
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Failed to retrieve collection: Error: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:03.77847361-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
    at IncomingMessage.<anonymous> (/home/runner/workspace/server/services/interBankService.ts:551:17)
    at IncomingMessage.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
[INTER] ❌ Erro ao obter PDF: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:03.77847361-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
[INTER] 🔄 Tentando endpoints alternativos...
[INTER] 🔄 Testando endpoints alternativos para PDF...
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/pdf/download
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/pdf/download
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-20/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-20/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:03 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-8f8d23f525102743eac9c8ae15da0774-e149c97bb0b4946a-00',
  'x-envoy-upstream-service-time': '57',
  'x-rate-limit-remaining': '119',
  'x-rate-limit-time': '1755089523801',
  'x-upstream-time': '60'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "214dc1d5-59c2-4497-a3ed-b421989ef167",
    "seuNumero": "SX83548-20",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-04-04",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348188",
    "codigoBarras": "07791177100000833330001112134234790398348188",
    "linhaDigitavel": "07790001161213423479303983481882117710000083333"
  },
  "pix": {
    "txid": "3464705361755009083000nMnoM02ud7zIy",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/b5a9497249954363b2e5d5e4db5c4c055204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***63043DF4"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983481882117710000083333
[INTER] 📊 Código de barras: 07791177100000833330001112134234790398348188
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/214dc1d5-59c2-4497-a3ed-b421989ef167/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/pdf/download: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/pdf/download falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/arquivo
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/arquivo
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:04 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-d2d3a583b4bb626a35f0023d65471927-bb7697cc8813193f-00',
  'x-envoy-upstream-service-time': '93',
  'x-rate-limit-remaining': '119',
  'x-rate-limit-time': '1755089524003',
  'x-upstream-time': '96',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 55462 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55452 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55452 caracteres
[INTER] ✅ PDF convertido: 41589 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41589 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43536 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 20 adicionada
[SECURE_CONTAINER] 📄 Baixando parcela 20
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: CORRETO-1755013508.325368-20
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: CORRETO-1755013508.325368-20
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-20
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/arquivo: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/arquivo falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/documento
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/documento
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 400 Bad Request
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '294',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:04 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-40bf751609a42a66839b064627433a89-d63eb6830a4a96df-00',
  'x-envoy-upstream-service-time': '4',
  'x-rate-limit-remaining': '114',
  'x-rate-limit-time': '1755089481923',
  'x-upstream-time': '27'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 294 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 400
[INTER] 🚨 Error Body: "{"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:04.275569466-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}"
[INTER] 🚨 Error Body Length: 288 chars
[INTER] 📋 Error as JSON: {
  "title": "Dados inválidos.",
  "detail": "Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.",
  "timestamp": "2025-08-13T09:51:04.275569466-03:00",
  "violacoes": [
    {
      "razao": "Não foi possível converter o valor.",
      "propriedade": "codigoSolicitacao"
    }
  ]
}
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Failed to retrieve collection: Error: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:04.275569466-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
    at IncomingMessage.<anonymous> (/home/runner/workspace/server/services/interBankService.ts:551:17)
    at IncomingMessage.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
[INTER] ❌ Erro ao obter PDF: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:04.275569466-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
[INTER] 🔄 Tentando endpoints alternativos...
[INTER] 🔄 Testando endpoints alternativos para PDF...
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/pdf/download
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/pdf/download
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:51:04 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-20/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-20/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 20: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 21
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: CORRETO-1755013508.325368-21
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: CORRETO-1755013508.325368-21
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-21
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/pdf/download: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/pdf/download falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/arquivo
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/arquivo
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/arquivo: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/arquivo falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/documento
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/documento
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 400 Bad Request
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '294',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:04 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-34013468c9c797aa27cefc0524ba89a5-dbc2d9f09e5c78f4-00',
  'x-envoy-upstream-service-time': '7',
  'x-rate-limit-remaining': '117',
  'x-rate-limit-time': '1755089483389',
  'x-upstream-time': '10'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 294 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 400
[INTER] 🚨 Error Body: "{"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:04.511196801-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}"
[INTER] 🚨 Error Body Length: 288 chars
[INTER] 📋 Error as JSON: {
  "title": "Dados inválidos.",
  "detail": "Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.",
  "timestamp": "2025-08-13T09:51:04.511196801-03:00",
  "violacoes": [
    {
      "razao": "Não foi possível converter o valor.",
      "propriedade": "codigoSolicitacao"
    }
  ]
}
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Failed to retrieve collection: Error: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:04.511196801-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
    at IncomingMessage.<anonymous> (/home/runner/workspace/server/services/interBankService.ts:551:17)
    at IncomingMessage.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
[INTER] ❌ Erro ao obter PDF: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:04.511196801-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
[INTER] 🔄 Tentando endpoints alternativos...
[INTER] 🔄 Testando endpoints alternativos para PDF...
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/pdf/download
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/pdf/download
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/pdf/download: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/pdf/download falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/arquivo
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/arquivo
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-20/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-20/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/arquivo: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/arquivo falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/documento
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/documento
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-20/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-20/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/arquivo: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/arquivo falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/documento
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/documento
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:51:05 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-20/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-20/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 20: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 21
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: CORRETO-1755013508.325368-21
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: CORRETO-1755013508.325368-21
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-21
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 400 Bad Request
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '293',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:05 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-dbad15c45209d128392a848ef0d8ba9e-937f10a5e3a28ad9-00',
  'x-envoy-upstream-service-time': '5',
  'x-rate-limit-remaining': '116',
  'x-rate-limit-time': '1755089483389',
  'x-upstream-time': '7'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 293 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 400
[INTER] 🚨 Error Body: "{"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:05.35110867-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}"
[INTER] 🚨 Error Body Length: 287 chars
[INTER] 📋 Error as JSON: {
  "title": "Dados inválidos.",
  "detail": "Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.",
  "timestamp": "2025-08-13T09:51:05.35110867-03:00",
  "violacoes": [
    {
      "razao": "Não foi possível converter o valor.",
      "propriedade": "codigoSolicitacao"
    }
  ]
}
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Failed to retrieve collection: Error: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:05.35110867-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
    at IncomingMessage.<anonymous> (/home/runner/workspace/server/services/interBankService.ts:551:17)
    at IncomingMessage.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
[INTER] ❌ Erro ao obter PDF: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:05.35110867-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
[INTER] 🔄 Tentando endpoints alternativos...
[INTER] 🔄 Testando endpoints alternativos para PDF...
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/pdf/download
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/pdf/download
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-20/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-20/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-20/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:51:05 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-20/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-20/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 20: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 21
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: CORRETO-1755013508.325368-21
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: CORRETO-1755013508.325368-21
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-21
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/pdf/download: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/pdf/download falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/arquivo
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/arquivo
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 400 Bad Request
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '294',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:05 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-c827da5dce77d016f278e22d7ffb5614-bd5dfaf28acb771b-00',
  'x-envoy-upstream-service-time': '5',
  'x-rate-limit-remaining': '115',
  'x-rate-limit-time': '1755089483389',
  'x-upstream-time': '10'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 294 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 400
[INTER] 🚨 Error Body: "{"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:05.620975264-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}"
[INTER] 🚨 Error Body Length: 288 chars
[INTER] 📋 Error as JSON: {
  "title": "Dados inválidos.",
  "detail": "Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.",
  "timestamp": "2025-08-13T09:51:05.620975264-03:00",
  "violacoes": [
    {
      "razao": "Não foi possível converter o valor.",
      "propriedade": "codigoSolicitacao"
    }
  ]
}
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Failed to retrieve collection: Error: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:05.620975264-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
    at IncomingMessage.<anonymous> (/home/runner/workspace/server/services/interBankService.ts:551:17)
    at IncomingMessage.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
[INTER] ❌ Erro ao obter PDF: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:05.620975264-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
[INTER] 🔄 Tentando endpoints alternativos...
[INTER] 🔄 Testando endpoints alternativos para PDF...
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/pdf/download
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/pdf/download
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-21/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-21/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/pdf/download: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/pdf/download falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/arquivo
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/arquivo
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:51:05 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-20/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-20/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 20: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 21
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: CORRETO-1755013508.325368-21
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: CORRETO-1755013508.325368-21
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-21
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/arquivo: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/arquivo falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/documento
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/documento
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 400 Bad Request
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '294',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:06 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-5b113934d96efcd8c9bb9d44aa2ba44b-011cce9a44810c64-00',
  'x-envoy-upstream-service-time': '6',
  'x-rate-limit-remaining': '114',
  'x-rate-limit-time': '1755089483389',
  'x-upstream-time': '9'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 294 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 400
[INTER] 🚨 Error Body: "{"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:06.115966854-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}"
[INTER] 🚨 Error Body Length: 288 chars
[INTER] 📋 Error as JSON: {
  "title": "Dados inválidos.",
  "detail": "Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.",
  "timestamp": "2025-08-13T09:51:06.115966854-03:00",
  "violacoes": [
    {
      "razao": "Não foi possível converter o valor.",
      "propriedade": "codigoSolicitacao"
    }
  ]
}
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Failed to retrieve collection: Error: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:06.115966854-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
    at IncomingMessage.<anonymous> (/home/runner/workspace/server/services/interBankService.ts:551:17)
    at IncomingMessage.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
[INTER] ❌ Erro ao obter PDF: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:06.115966854-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
[INTER] 🔄 Tentando endpoints alternativos...
[INTER] 🔄 Testando endpoints alternativos para PDF...
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/pdf/download
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/pdf/download
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:51:06 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-21/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-21/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 21: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 21
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: 3721fc7d-3301-44bd-8836-072a2299d570
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: 3721fc7d-3301-44bd-8836-072a2299d570
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/3721fc7d-3301-44bd-8836-072a2299d570
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/pdf/download: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/pdf/download falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/arquivo
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/arquivo
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/arquivo: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/arquivo falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/documento
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/documento
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:06 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-cc866923b888b0d22dfbd4e53f1997b0-a675b03df9f48667-00',
  'x-envoy-upstream-service-time': '71',
  'x-rate-limit-remaining': '117',
  'x-rate-limit-time': '1755089485123',
  'x-upstream-time': '73'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "3721fc7d-3301-44bd-8836-072a2299d570",
    "seuNumero": "SX84442-21",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-05-04",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348204",
    "codigoBarras": "07799180100000833330001112134234790398348204",
    "linhaDigitavel": "07790001161213423479303983482047918010000083333"
  },
  "pix": {
    "txid": "3464705361755009084000WBTMcwhQygGpC",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/f7b8e0ad9acd42d18719810666ab842f5204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***630439F7"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983482047918010000083333
[INTER] 📊 Código de barras: 07799180100000833330001112134234790398348204
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/3721fc7d-3301-44bd-8836-072a2299d570/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-21/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-21/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/arquivo: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/arquivo falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/documento
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/documento
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:06 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-f3806103268271743b060660f9e054e9-38dbd08aa83d208e-00',
  'x-envoy-upstream-service-time': '87',
  'x-rate-limit-remaining': '117',
  'x-rate-limit-time': '1755089485323',
  'x-upstream-time': '88',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-21/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-21/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] 📦 Response buffer size: 55310 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55300 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55300 caracteres
[INTER] ✅ PDF convertido: 41473 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41473 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43412 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 21 adicionada
[SECURE_CONTAINER] 📄 Baixando parcela 22
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: CORRETO-1755013508.325368-22
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: CORRETO-1755013508.325368-22
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-22
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 400 Bad Request
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '294',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:07 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-8c378bb312d091080cffa63ec843888e-f472d6641b5a53a2-01',
  'x-envoy-upstream-service-time': '12',
  'x-rate-limit-remaining': '117',
  'x-rate-limit-time': '1755089485878',
  'x-upstream-time': '15'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 294 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 400
[INTER] 🚨 Error Body: "{"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:07.053743817-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}"
[INTER] 🚨 Error Body Length: 288 chars
[INTER] 📋 Error as JSON: {
  "title": "Dados inválidos.",
  "detail": "Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.",
  "timestamp": "2025-08-13T09:51:07.053743817-03:00",
  "violacoes": [
    {
      "razao": "Não foi possível converter o valor.",
      "propriedade": "codigoSolicitacao"
    }
  ]
}
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Failed to retrieve collection: Error: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:07.053743817-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
    at IncomingMessage.<anonymous> (/home/runner/workspace/server/services/interBankService.ts:551:17)
    at IncomingMessage.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
[INTER] ❌ Erro ao obter PDF: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:07.053743817-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
[INTER] 🔄 Tentando endpoints alternativos...
[INTER] 🔄 Testando endpoints alternativos para PDF...
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/pdf/download
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/pdf/download
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:51:07 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-21/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-21/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 21: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 21
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: 3721fc7d-3301-44bd-8836-072a2299d570
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: 3721fc7d-3301-44bd-8836-072a2299d570
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/3721fc7d-3301-44bd-8836-072a2299d570
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-21/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-21/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-21/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/pdf/download: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/pdf/download falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/arquivo
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/arquivo
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:51:07 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-21/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-21/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 21: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 21
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: 3721fc7d-3301-44bd-8836-072a2299d570
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: 3721fc7d-3301-44bd-8836-072a2299d570
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/3721fc7d-3301-44bd-8836-072a2299d570
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:07 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-bde164a950a8982c51b02371d2b928a6-489a2759fa442a05-00',
  'x-envoy-upstream-service-time': '148',
  'x-rate-limit-remaining': '116',
  'x-rate-limit-time': '1755089485123',
  'x-upstream-time': '167'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "3721fc7d-3301-44bd-8836-072a2299d570",
    "seuNumero": "SX84442-21",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-05-04",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348204",
    "codigoBarras": "07799180100000833330001112134234790398348204",
    "linhaDigitavel": "07790001161213423479303983482047918010000083333"
  },
  "pix": {
    "txid": "3464705361755009084000WBTMcwhQygGpC",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/f7b8e0ad9acd42d18719810666ab842f5204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***630439F7"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983482047918010000083333
[INTER] 📊 Código de barras: 07799180100000833330001112134234790398348204
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/3721fc7d-3301-44bd-8836-072a2299d570/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:07 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-007c33dea75324071a304ef27ec45e7b-d0682bc221fee527-00',
  'x-envoy-upstream-service-time': '82',
  'x-rate-limit-remaining': '115',
  'x-rate-limit-time': '1755089485123',
  'x-upstream-time': '85'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "3721fc7d-3301-44bd-8836-072a2299d570",
    "seuNumero": "SX84442-21",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-05-04",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348204",
    "codigoBarras": "07799180100000833330001112134234790398348204",
    "linhaDigitavel": "07790001161213423479303983482047918010000083333"
  },
  "pix": {
    "txid": "3464705361755009084000WBTMcwhQygGpC",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/f7b8e0ad9acd42d18719810666ab842f5204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***630439F7"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983482047918010000083333
[INTER] 📊 Código de barras: 07799180100000833330001112134234790398348204
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/3721fc7d-3301-44bd-8836-072a2299d570/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:07 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-696f0b599cb90fe38ab886fcade3352f-5c06faab8f330542-00',
  'x-envoy-upstream-service-time': '88',
  'x-rate-limit-remaining': '116',
  'x-rate-limit-time': '1755089485323',
  'x-upstream-time': '90',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:51:07 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-21/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-21/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 21: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 21
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: 3721fc7d-3301-44bd-8836-072a2299d570
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: 3721fc7d-3301-44bd-8836-072a2299d570
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/3721fc7d-3301-44bd-8836-072a2299d570
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/arquivo: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/arquivo falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/documento
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/documento
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:07 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-c93046597a24876189525cb24deb5515-0170b0f398483d32-00',
  'x-envoy-upstream-service-time': '80',
  'x-rate-limit-remaining': '115',
  'x-rate-limit-time': '1755089485323',
  'x-upstream-time': '92',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 55310 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55300 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55300 caracteres
[INTER] ✅ PDF convertido: 41473 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41473 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43417 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 21 adicionada
[SECURE_CONTAINER] 📄 Baixando parcela 22
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: CORRETO-1755013508.325368-22
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: CORRETO-1755013508.325368-22
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-22
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:07 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-aff59eef49e3645fb0e473a29760c7d9-0a7c63a793708a01-00',
  'x-envoy-upstream-service-time': '90',
  'x-rate-limit-remaining': '114',
  'x-rate-limit-time': '1755089485123',
  'x-upstream-time': '92'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "3721fc7d-3301-44bd-8836-072a2299d570",
    "seuNumero": "SX84442-21",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-05-04",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348204",
    "codigoBarras": "07799180100000833330001112134234790398348204",
    "linhaDigitavel": "07790001161213423479303983482047918010000083333"
  },
  "pix": {
    "txid": "3464705361755009084000WBTMcwhQygGpC",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/f7b8e0ad9acd42d18719810666ab842f5204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***630439F7"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983482047918010000083333
[INTER] 📊 Código de barras: 07799180100000833330001112134234790398348204
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/3721fc7d-3301-44bd-8836-072a2299d570/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 400 Bad Request
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '294',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:07 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-04cc096510b9159e285adc69881b701c-1d091d7bf639bf95-00',
  'x-envoy-upstream-service-time': '4',
  'x-rate-limit-remaining': '116',
  'x-rate-limit-time': '1755089485878',
  'x-upstream-time': '5'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 294 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 400
[INTER] 🚨 Error Body: "{"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:07.995300466-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}"
[INTER] 🚨 Error Body Length: 288 chars
[INTER] 📋 Error as JSON: {
  "title": "Dados inválidos.",
  "detail": "Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.",
  "timestamp": "2025-08-13T09:51:07.995300466-03:00",
  "violacoes": [
    {
      "razao": "Não foi possível converter o valor.",
      "propriedade": "codigoSolicitacao"
    }
  ]
}
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Failed to retrieve collection: Error: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:07.995300466-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
    at IncomingMessage.<anonymous> (/home/runner/workspace/server/services/interBankService.ts:551:17)
    at IncomingMessage.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
[INTER] ❌ Erro ao obter PDF: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:07.995300466-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
[INTER] 🔄 Tentando endpoints alternativos...
[INTER] 🔄 Testando endpoints alternativos para PDF...
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/pdf/download
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/pdf/download
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] 📦 Response buffer size: 55310 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55300 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55300 caracteres
[INTER] ✅ PDF convertido: 41473 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41473 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43417 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 21 adicionada
[SECURE_CONTAINER] 📄 Baixando parcela 22
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: CORRETO-1755013508.325368-22
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: CORRETO-1755013508.325368-22
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-22
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/pdf/download: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/pdf/download falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/arquivo
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/arquivo
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:08 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-e065af51c7c4c81221c4c12acb1fb9cb-f358a5c16d6be5a7-00',
  'x-envoy-upstream-service-time': '97',
  'x-rate-limit-remaining': '114',
  'x-rate-limit-time': '1755089485323',
  'x-upstream-time': '102',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 400 Bad Request
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '294',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:08 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-10eeadd9b0e7aea8d2d39f54a76a1071-c8ef5ae3a6be7bd3-00',
  'x-envoy-upstream-service-time': '3',
  'x-rate-limit-remaining': '115',
  'x-rate-limit-time': '1755089485878',
  'x-upstream-time': '7'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 294 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 400
[INTER] 🚨 Error Body: "{"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:08.177092032-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}"
[INTER] 🚨 Error Body Length: 288 chars
[INTER] 📋 Error as JSON: {
  "title": "Dados inválidos.",
  "detail": "Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.",
  "timestamp": "2025-08-13T09:51:08.177092032-03:00",
  "violacoes": [
    {
      "razao": "Não foi possível converter o valor.",
      "propriedade": "codigoSolicitacao"
    }
  ]
}
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Failed to retrieve collection: Error: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:08.177092032-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
    at IncomingMessage.<anonymous> (/home/runner/workspace/server/services/interBankService.ts:551:17)
    at IncomingMessage.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
[INTER] ❌ Erro ao obter PDF: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:08.177092032-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
[INTER] 🔄 Tentando endpoints alternativos...
[INTER] 🔄 Testando endpoints alternativos para PDF...
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/pdf/download
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/pdf/download
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-22/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-22/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/pdf/download: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/pdf/download falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/arquivo
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/arquivo
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] 📦 Response buffer size: 55310 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55300 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55300 caracteres
[INTER] ✅ PDF convertido: 41473 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41473 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43422 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 21 adicionada
[SECURE_CONTAINER] 📄 Baixando parcela 22
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: CORRETO-1755013508.325368-22
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: CORRETO-1755013508.325368-22
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-22
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 400 Bad Request
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '294',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:08 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-a3e649c4c05710e712f595b3b5f4d968-f53fc812439cd28b-01',
  'x-envoy-upstream-service-time': '6',
  'x-rate-limit-remaining': '114',
  'x-rate-limit-time': '1755089485878',
  'x-upstream-time': '27'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 294 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 400
[INTER] 🚨 Error Body: "{"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:08.579184941-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}"
[INTER] 🚨 Error Body Length: 288 chars
[INTER] 📋 Error as JSON: {
  "title": "Dados inválidos.",
  "detail": "Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.",
  "timestamp": "2025-08-13T09:51:08.579184941-03:00",
  "violacoes": [
    {
      "razao": "Não foi possível converter o valor.",
      "propriedade": "codigoSolicitacao"
    }
  ]
}
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Failed to retrieve collection: Error: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:08.579184941-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
    at IncomingMessage.<anonymous> (/home/runner/workspace/server/services/interBankService.ts:551:17)
    at IncomingMessage.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
[INTER] ❌ Erro ao obter PDF: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:08.579184941-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
[INTER] 🔄 Tentando endpoints alternativos...
[INTER] 🔄 Testando endpoints alternativos para PDF...
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/pdf/download
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/pdf/download
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/arquivo: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/arquivo falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/documento
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/documento
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/arquivo: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/arquivo falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/documento
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/documento
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/pdf/download: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/pdf/download falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/arquivo
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/arquivo
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:51:08 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-22/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-22/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 22: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 22
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: 24cf3f92-ec3d-49c9-a99f-8639a759115c
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: 24cf3f92-ec3d-49c9-a99f-8639a759115c
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/24cf3f92-ec3d-49c9-a99f-8639a759115c
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:08 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-1bfa1112b6b5b371037868e34f995450-fd8c83a32424e60a-01',
  'x-envoy-upstream-service-time': '78',
  'x-rate-limit-remaining': '117',
  'x-rate-limit-time': '1755089487714',
  'x-upstream-time': '80'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "24cf3f92-ec3d-49c9-a99f-8639a759115c",
    "seuNumero": "SX85371-22",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-06-03",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348238",
    "codigoBarras": "07797183100000833330001112134234790398348238",
    "linhaDigitavel": "07790001161213423479303983482385718310000083333"
  },
  "pix": {
    "txid": "3464705361755009085000B8yZXTHglw9jB",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/c1b76a19d92c4cf1b6344b0312ff93435204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***6304CDD9"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983482385718310000083333
[INTER] 📊 Código de barras: 07797183100000833330001112134234790398348238
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/24cf3f92-ec3d-49c9-a99f-8639a759115c/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-22/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-22/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-22/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-22/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/arquivo: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/arquivo falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/documento
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/documento
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:09 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-4fe5abefc2093f148147d4a939c83df5-cd148268436b95d8-00',
  'x-envoy-upstream-service-time': '119',
  'x-rate-limit-remaining': '117',
  'x-rate-limit-time': '1755089487922',
  'x-upstream-time': '122',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 55274 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55264 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55264 caracteres
[INTER] ✅ PDF convertido: 41447 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41447 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43386 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 22 adicionada
[SECURE_CONTAINER] 📄 Baixando parcela 23
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: 66715aeb-5beb-4258-82b1-db684ec91c86
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: 66715aeb-5beb-4258-82b1-db684ec91c86
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/66715aeb-5beb-4258-82b1-db684ec91c86
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:51:09 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-22/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-22/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 22: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 22
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: 24cf3f92-ec3d-49c9-a99f-8639a759115c
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: 24cf3f92-ec3d-49c9-a99f-8639a759115c
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/24cf3f92-ec3d-49c9-a99f-8639a759115c
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:09 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-9cc8cffd8d9315480192175c18f97d97-f918526286b64395-01',
  'x-envoy-upstream-service-time': '69',
  'x-rate-limit-remaining': '117',
  'x-rate-limit-time': '1755089488458',
  'x-upstream-time': '71'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "66715aeb-5beb-4258-82b1-db684ec91c86",
    "seuNumero": "SX86285-23",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-07-03",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348261",
    "codigoBarras": "07795186100000833330001112134234790398348261",
    "linhaDigitavel": "07790001161213423479303983482617518610000083333"
  },
  "pix": {
    "txid": "3464705361755009086000Wm3JdI1bjOcoW",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/e46f0ef860764be98583e93717755f505204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***630464B2"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983482617518610000083333
[INTER] 📊 Código de barras: 07795186100000833330001112134234790398348261
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/66715aeb-5beb-4258-82b1-db684ec91c86/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:51:09 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-22/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-22/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 22: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 22
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: 24cf3f92-ec3d-49c9-a99f-8639a759115c
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: 24cf3f92-ec3d-49c9-a99f-8639a759115c
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/24cf3f92-ec3d-49c9-a99f-8639a759115c
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-22/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-22/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-22/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:09 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-fc9fdef2851cf277de1554534342568c-28e5387725471d3c-00',
  'x-envoy-upstream-service-time': '63',
  'x-rate-limit-remaining': '116',
  'x-rate-limit-time': '1755089487714',
  'x-upstream-time': '68'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "24cf3f92-ec3d-49c9-a99f-8639a759115c",
    "seuNumero": "SX85371-22",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-06-03",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348238",
    "codigoBarras": "07797183100000833330001112134234790398348238",
    "linhaDigitavel": "07790001161213423479303983482385718310000083333"
  },
  "pix": {
    "txid": "3464705361755009085000B8yZXTHglw9jB",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/c1b76a19d92c4cf1b6344b0312ff93435204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***6304CDD9"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983482385718310000083333
[INTER] 📊 Código de barras: 07797183100000833330001112134234790398348238
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/24cf3f92-ec3d-49c9-a99f-8639a759115c/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:09 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-84edec2413ab15a44725b778ca2dc678-c4b2428aebddce5d-00',
  'x-envoy-upstream-service-time': '62',
  'x-rate-limit-remaining': '115',
  'x-rate-limit-time': '1755089487714',
  'x-upstream-time': '66'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "24cf3f92-ec3d-49c9-a99f-8639a759115c",
    "seuNumero": "SX85371-22",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-06-03",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348238",
    "codigoBarras": "07797183100000833330001112134234790398348238",
    "linhaDigitavel": "07790001161213423479303983482385718310000083333"
  },
  "pix": {
    "txid": "3464705361755009085000B8yZXTHglw9jB",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/c1b76a19d92c4cf1b6344b0312ff93435204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***6304CDD9"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983482385718310000083333
[INTER] 📊 Código de barras: 07797183100000833330001112134234790398348238
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/24cf3f92-ec3d-49c9-a99f-8639a759115c/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:09 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-6c9a5b85c4017b5fd437c128f765303a-273d13e142a1519e-00',
  'x-envoy-upstream-service-time': '89',
  'x-rate-limit-remaining': '117',
  'x-rate-limit-time': '1755089488711',
  'x-upstream-time': '91',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 55618 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55608 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55608 caracteres
[INTER] ✅ PDF convertido: 41706 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41706 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43645 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 23 adicionada
[SECURE_CONTAINER] 📄 Baixando parcela 23
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: CORRETO-1755013508.325368-23
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: CORRETO-1755013508.325368-23
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-23
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:09 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-6daf838122b823c1569f361f058117ff-ba1913c189693ce9-00',
  'x-envoy-upstream-service-time': '84',
  'x-rate-limit-remaining': '116',
  'x-rate-limit-time': '1755089487922',
  'x-upstream-time': '89',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 400 Bad Request
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '294',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:10 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-e92d50eaf14a1302d6e80de147b18cb4-e94c1bdc06f19b61-00',
  'x-envoy-upstream-service-time': '4',
  'x-rate-limit-remaining': '117',
  'x-rate-limit-time': '1755089489098',
  'x-upstream-time': '6'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 294 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 400
[INTER] 🚨 Error Body: "{"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:10.112791796-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}"
[INTER] 🚨 Error Body Length: 288 chars
[INTER] 📋 Error as JSON: {
  "title": "Dados inválidos.",
  "detail": "Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.",
  "timestamp": "2025-08-13T09:51:10.112791796-03:00",
  "violacoes": [
    {
      "razao": "Não foi possível converter o valor.",
      "propriedade": "codigoSolicitacao"
    }
  ]
}
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Failed to retrieve collection: Error: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:10.112791796-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
    at IncomingMessage.<anonymous> (/home/runner/workspace/server/services/interBankService.ts:551:17)
    at IncomingMessage.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
[INTER] ❌ Erro ao obter PDF: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:10.112791796-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
[INTER] 🔄 Tentando endpoints alternativos...
[INTER] 🔄 Testando endpoints alternativos para PDF...
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/pdf/download
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/pdf/download
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:10 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-2519a3af2955d8d2104c16583edb7337-29921b50f6eca158-01',
  'x-envoy-upstream-service-time': '99',
  'x-rate-limit-remaining': '115',
  'x-rate-limit-time': '1755089487922',
  'x-upstream-time': '101',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/pdf/download: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/pdf/download falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/arquivo
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/arquivo
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] 📦 Response buffer size: 55274 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55264 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55264 caracteres
[INTER] ✅ PDF convertido: 41447 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41447 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43394 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 22 adicionada
[SECURE_CONTAINER] 📄 Baixando parcela 23
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: 66715aeb-5beb-4258-82b1-db684ec91c86
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: 66715aeb-5beb-4258-82b1-db684ec91c86
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/66715aeb-5beb-4258-82b1-db684ec91c86
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:51:10 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-22/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-22/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 22: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 22
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: 24cf3f92-ec3d-49c9-a99f-8639a759115c
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: 24cf3f92-ec3d-49c9-a99f-8639a759115c
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/24cf3f92-ec3d-49c9-a99f-8639a759115c
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] 📦 Response buffer size: 55274 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55264 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55264 caracteres
[INTER] ✅ PDF convertido: 41447 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41447 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43386 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 22 adicionada
[SECURE_CONTAINER] 📄 Baixando parcela 23
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: 66715aeb-5beb-4258-82b1-db684ec91c86
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: 66715aeb-5beb-4258-82b1-db684ec91c86
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/66715aeb-5beb-4258-82b1-db684ec91c86
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:10 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-e72546f6584cecfc78b48df63a59d31b-fb1b9e393ac14362-00',
  'x-envoy-upstream-service-time': '71',
  'x-rate-limit-remaining': '116',
  'x-rate-limit-time': '1755089488458',
  'x-upstream-time': '73'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "66715aeb-5beb-4258-82b1-db684ec91c86",
    "seuNumero": "SX86285-23",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-07-03",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348261",
    "codigoBarras": "07795186100000833330001112134234790398348261",
    "linhaDigitavel": "07790001161213423479303983482617518610000083333"
  },
  "pix": {
    "txid": "3464705361755009086000Wm3JdI1bjOcoW",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/e46f0ef860764be98583e93717755f505204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***630464B2"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983482617518610000083333
[INTER] 📊 Código de barras: 07795186100000833330001112134234790398348261
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/66715aeb-5beb-4258-82b1-db684ec91c86/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:10 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-dace90907c66b70522ce44f425cb0fc3-9091bf926d83b7a0-00',
  'x-envoy-upstream-service-time': '69',
  'x-rate-limit-remaining': '114',
  'x-rate-limit-time': '1755089487714',
  'x-upstream-time': '70'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "24cf3f92-ec3d-49c9-a99f-8639a759115c",
    "seuNumero": "SX85371-22",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-06-03",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348238",
    "codigoBarras": "07797183100000833330001112134234790398348238",
    "linhaDigitavel": "07790001161213423479303983482385718310000083333"
  },
  "pix": {
    "txid": "3464705361755009085000B8yZXTHglw9jB",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/c1b76a19d92c4cf1b6344b0312ff93435204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***6304CDD9"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983482385718310000083333
[INTER] 📊 Código de barras: 07797183100000833330001112134234790398348238
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/24cf3f92-ec3d-49c9-a99f-8639a759115c/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/arquivo: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/arquivo falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/documento
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/documento
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:10 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-2324eb2f8f83fff42e6bfbb84ae533f8-710fd57c52e9a81d-00',
  'x-envoy-upstream-service-time': '76',
  'x-rate-limit-remaining': '115',
  'x-rate-limit-time': '1755089488458',
  'x-upstream-time': '77'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "66715aeb-5beb-4258-82b1-db684ec91c86",
    "seuNumero": "SX86285-23",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-07-03",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348261",
    "codigoBarras": "07795186100000833330001112134234790398348261",
    "linhaDigitavel": "07790001161213423479303983482617518610000083333"
  },
  "pix": {
    "txid": "3464705361755009086000Wm3JdI1bjOcoW",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/e46f0ef860764be98583e93717755f505204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***630464B2"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983482617518610000083333
[INTER] 📊 Código de barras: 07795186100000833330001112134234790398348261
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/66715aeb-5beb-4258-82b1-db684ec91c86/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:10 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-a9f2e5ecc4f6d054be7dfb4abf494d6d-0dba9671f490e7b9-00',
  'x-envoy-upstream-service-time': '102',
  'x-rate-limit-remaining': '114',
  'x-rate-limit-time': '1755089487922',
  'x-upstream-time': '104',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:10 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-1b8b21712142f235d7939e47a5e3a435-317999182cb47022-00',
  'x-envoy-upstream-service-time': '119',
  'x-rate-limit-remaining': '116',
  'x-rate-limit-time': '1755089488711',
  'x-upstream-time': '120',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 55618 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55608 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55608 caracteres
[INTER] ✅ PDF convertido: 41706 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41706 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43649 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 23 adicionada
[SECURE_CONTAINER] 📄 Baixando parcela 23
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: CORRETO-1755013508.325368-23
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: CORRETO-1755013508.325368-23
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-23
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 400 Bad Request
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '294',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:10 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-2d78b1ab33afc6fd2df414f88c7eba2c-913a7aa2d6e3ca43-00',
  'x-envoy-upstream-service-time': '4',
  'x-rate-limit-remaining': '116',
  'x-rate-limit-time': '1755089489098',
  'x-upstream-time': '8'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 294 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 400
[INTER] 🚨 Error Body: "{"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:10.880326038-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}"
[INTER] 🚨 Error Body Length: 288 chars
[INTER] 📋 Error as JSON: {
  "title": "Dados inválidos.",
  "detail": "Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.",
  "timestamp": "2025-08-13T09:51:10.880326038-03:00",
  "violacoes": [
    {
      "razao": "Não foi possível converter o valor.",
      "propriedade": "codigoSolicitacao"
    }
  ]
}
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Failed to retrieve collection: Error: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:10.880326038-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
    at IncomingMessage.<anonymous> (/home/runner/workspace/server/services/interBankService.ts:551:17)
    at IncomingMessage.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
[INTER] ❌ Erro ao obter PDF: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:10.880326038-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
[INTER] 🔄 Tentando endpoints alternativos...
[INTER] 🔄 Testando endpoints alternativos para PDF...
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/pdf/download
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/pdf/download
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:10 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-6cfd248f80cd1457f525b2bd60b0b3b0-aef7004d0f706b2d-00',
  'x-envoy-upstream-service-time': '122',
  'x-rate-limit-remaining': '115',
  'x-rate-limit-time': '1755089488711',
  'x-upstream-time': '124',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 55618 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55608 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55608 caracteres
[INTER] ✅ PDF convertido: 41706 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41706 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43651 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 23 adicionada
[SECURE_CONTAINER] 📄 Baixando parcela 23
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: CORRETO-1755013508.325368-23
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: CORRETO-1755013508.325368-23
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-23
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] 📦 Response buffer size: 55274 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55264 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55264 caracteres
[INTER] ✅ PDF convertido: 41447 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41447 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43392 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 22 adicionada
[SECURE_CONTAINER] 📄 Baixando parcela 23
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: 66715aeb-5beb-4258-82b1-db684ec91c86
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: 66715aeb-5beb-4258-82b1-db684ec91c86
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/66715aeb-5beb-4258-82b1-db684ec91c86
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/pdf/download: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/pdf/download falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/arquivo
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/arquivo
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 400 Bad Request
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '294',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:11 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-586b35c31615988bd679cb46f5f47b23-14f29870344dd353-00',
  'x-envoy-upstream-service-time': '5',
  'x-rate-limit-remaining': '115',
  'x-rate-limit-time': '1755089489098',
  'x-upstream-time': '7'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 294 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 400
[INTER] 🚨 Error Body: "{"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:11.067772371-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}"
[INTER] 🚨 Error Body Length: 288 chars
[INTER] 📋 Error as JSON: {
  "title": "Dados inválidos.",
  "detail": "Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.",
  "timestamp": "2025-08-13T09:51:11.067772371-03:00",
  "violacoes": [
    {
      "razao": "Não foi possível converter o valor.",
      "propriedade": "codigoSolicitacao"
    }
  ]
}
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Failed to retrieve collection: Error: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:11.067772371-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
    at IncomingMessage.<anonymous> (/home/runner/workspace/server/services/interBankService.ts:551:17)
    at IncomingMessage.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
[INTER] ❌ Erro ao obter PDF: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:11.067772371-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
[INTER] 🔄 Tentando endpoints alternativos...
[INTER] 🔄 Testando endpoints alternativos para PDF...
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/pdf/download
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/pdf/download
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-23/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-23/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/pdf/download: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/pdf/download falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/arquivo
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/arquivo
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:11 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-072277d6344e668bb7b4e2e51f6482f7-f12a54043c88c19e-00',
  'x-envoy-upstream-service-time': '102',
  'x-rate-limit-remaining': '114',
  'x-rate-limit-time': '1755089488458',
  'x-upstream-time': '104'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "66715aeb-5beb-4258-82b1-db684ec91c86",
    "seuNumero": "SX86285-23",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-07-03",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348261",
    "codigoBarras": "07795186100000833330001112134234790398348261",
    "linhaDigitavel": "07790001161213423479303983482617518610000083333"
  },
  "pix": {
    "txid": "3464705361755009086000Wm3JdI1bjOcoW",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/e46f0ef860764be98583e93717755f505204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***630464B2"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983482617518610000083333
[INTER] 📊 Código de barras: 07795186100000833330001112134234790398348261
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/66715aeb-5beb-4258-82b1-db684ec91c86/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:11 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-ba00585b4099fdd15262d5340ece8b5f-d29e479f4827dfc3-00',
  'x-envoy-upstream-service-time': '98',
  'x-rate-limit-remaining': '114',
  'x-rate-limit-time': '1755089488711',
  'x-upstream-time': '99',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 55618 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55608 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55608 caracteres
[INTER] ✅ PDF convertido: 41706 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41706 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43650 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 23 adicionada
[SECURE_CONTAINER] 📄 Baixando parcela 23
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: CORRETO-1755013508.325368-23
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: CORRETO-1755013508.325368-23
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-23
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/arquivo: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/arquivo falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/documento
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/documento
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/arquivo: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/arquivo falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/documento
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/documento
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 400 Bad Request
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '294',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:11 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-ccd44e1d4cba66a94fd268c04b1148f3-0cc3abb15ca39d79-00',
  'x-envoy-upstream-service-time': '5',
  'x-rate-limit-remaining': '114',
  'x-rate-limit-time': '1755089489098',
  'x-upstream-time': '7'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 294 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 400
[INTER] 🚨 Error Body: "{"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:11.616549303-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}"
[INTER] 🚨 Error Body Length: 288 chars
[INTER] 📋 Error as JSON: {
  "title": "Dados inválidos.",
  "detail": "Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.",
  "timestamp": "2025-08-13T09:51:11.616549303-03:00",
  "violacoes": [
    {
      "razao": "Não foi possível converter o valor.",
      "propriedade": "codigoSolicitacao"
    }
  ]
}
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Failed to retrieve collection: Error: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:11.616549303-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
    at IncomingMessage.<anonymous> (/home/runner/workspace/server/services/interBankService.ts:551:17)
    at IncomingMessage.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
[INTER] ❌ Erro ao obter PDF: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:11.616549303-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
[INTER] 🔄 Tentando endpoints alternativos...
[INTER] 🔄 Testando endpoints alternativos para PDF...
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/pdf/download
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/pdf/download
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:51:11 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-23/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-23/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 23: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 24
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: CORRETO-1755013508.325368-24
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: CORRETO-1755013508.325368-24
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-24
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/pdf/download: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/pdf/download falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/arquivo
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/arquivo
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 400 Bad Request
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '294',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:11 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-bb2e9283d6dc6a1a7c0f1e0713dbe15d-63149842b42020e2-00',
  'x-envoy-upstream-service-time': '5',
  'x-rate-limit-remaining': '117',
  'x-rate-limit-time': '1755089490810',
  'x-upstream-time': '32'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 294 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 400
[INTER] 🚨 Error Body: "{"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:11.854106481-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}"
[INTER] 🚨 Error Body Length: 288 chars
[INTER] 📋 Error as JSON: {
  "title": "Dados inválidos.",
  "detail": "Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.",
  "timestamp": "2025-08-13T09:51:11.854106481-03:00",
  "violacoes": [
    {
      "razao": "Não foi possível converter o valor.",
      "propriedade": "codigoSolicitacao"
    }
  ]
}
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Failed to retrieve collection: Error: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:11.854106481-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
    at IncomingMessage.<anonymous> (/home/runner/workspace/server/services/interBankService.ts:551:17)
    at IncomingMessage.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
[INTER] ❌ Erro ao obter PDF: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:11.854106481-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
[INTER] 🔄 Tentando endpoints alternativos...
[INTER] 🔄 Testando endpoints alternativos para PDF...
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/pdf/download
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/pdf/download
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/pdf/download: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/pdf/download falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/arquivo
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/arquivo
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-23/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-23/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-23/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-23/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/arquivo: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/arquivo falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/documento
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/documento
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/arquivo: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/arquivo falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/documento
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/documento
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:51:12 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-23/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-23/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 23: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 24
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: CORRETO-1755013508.325368-24
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: CORRETO-1755013508.325368-24
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-24
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:51:12 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-23/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-23/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 23: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 24
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: CORRETO-1755013508.325368-24
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: CORRETO-1755013508.325368-24
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-24
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 400 Bad Request
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '294',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:12 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-066b9c9c80d731948599e82504ba04a8-c9bf975d46b36eaa-00',
  'x-envoy-upstream-service-time': '7',
  'x-rate-limit-remaining': '116',
  'x-rate-limit-time': '1755089490810',
  'x-upstream-time': '31'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 294 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 400
[INTER] 🚨 Error Body: "{"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:12.753034186-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}"
[INTER] 🚨 Error Body Length: 288 chars
[INTER] 📋 Error as JSON: {
  "title": "Dados inválidos.",
  "detail": "Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.",
  "timestamp": "2025-08-13T09:51:12.753034186-03:00",
  "violacoes": [
    {
      "razao": "Não foi possível converter o valor.",
      "propriedade": "codigoSolicitacao"
    }
  ]
}
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Failed to retrieve collection: Error: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:12.753034186-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
    at IncomingMessage.<anonymous> (/home/runner/workspace/server/services/interBankService.ts:551:17)
    at IncomingMessage.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
[INTER] ❌ Erro ao obter PDF: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:12.753034186-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
[INTER] 🔄 Tentando endpoints alternativos...
[INTER] 🔄 Testando endpoints alternativos para PDF...
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/pdf/download
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/pdf/download
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-23/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-23/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-23/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 400 Bad Request
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '294',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:12 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-1c6136accf75fb35bc642e1d47cedf72-7e30b91b3994d2d1-00',
  'x-envoy-upstream-service-time': '5',
  'x-rate-limit-remaining': '115',
  'x-rate-limit-time': '1755089490810',
  'x-upstream-time': '8'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 294 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 400
[INTER] 🚨 Error Body: "{"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:12.783973526-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}"
[INTER] 🚨 Error Body Length: 288 chars
[INTER] 📋 Error as JSON: {
  "title": "Dados inválidos.",
  "detail": "Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.",
  "timestamp": "2025-08-13T09:51:12.783973526-03:00",
  "violacoes": [
    {
      "razao": "Não foi possível converter o valor.",
      "propriedade": "codigoSolicitacao"
    }
  ]
}
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Failed to retrieve collection: Error: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:12.783973526-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
    at IncomingMessage.<anonymous> (/home/runner/workspace/server/services/interBankService.ts:551:17)
    at IncomingMessage.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
[INTER] ❌ Erro ao obter PDF: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:12.783973526-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
[INTER] 🔄 Tentando endpoints alternativos...
[INTER] 🔄 Testando endpoints alternativos para PDF...
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/pdf/download
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/pdf/download
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/pdf/download: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/pdf/download falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/arquivo
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/arquivo
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/pdf/download: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/pdf/download falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/arquivo
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/arquivo
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-24/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-24/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:51:13 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-23/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-23/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 23: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 24
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: CORRETO-1755013508.325368-24
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: CORRETO-1755013508.325368-24
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-24
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/arquivo: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/arquivo falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/documento
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/documento
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/arquivo: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/arquivo falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/documento
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/documento
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 400 Bad Request
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '293',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:13 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-5905958d0eb6c0f98a6c71edacbbcee3-cf5ce3e98ca46154-00',
  'x-envoy-upstream-service-time': '5',
  'x-rate-limit-remaining': '114',
  'x-rate-limit-time': '1755089490810',
  'x-upstream-time': '8'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 293 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 400
[INTER] 🚨 Error Body: "{"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:13.44686711-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}"
[INTER] 🚨 Error Body Length: 287 chars
[INTER] 📋 Error as JSON: {
  "title": "Dados inválidos.",
  "detail": "Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.",
  "timestamp": "2025-08-13T09:51:13.44686711-03:00",
  "violacoes": [
    {
      "razao": "Não foi possível converter o valor.",
      "propriedade": "codigoSolicitacao"
    }
  ]
}
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Failed to retrieve collection: Error: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:13.44686711-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
    at IncomingMessage.<anonymous> (/home/runner/workspace/server/services/interBankService.ts:551:17)
    at IncomingMessage.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
[INTER] ❌ Erro ao obter PDF: Inter API error: 400 - {"title":"Dados inválidos.","detail":"Verifique se os dados informados estão de acordo com a documentação disponibilizada e tente novamente.","timestamp":"2025-08-13T09:51:13.44686711-03:00","violacoes":[{"razao":"Não foi possível converter o valor.","propriedade":"codigoSolicitacao"}]}
[INTER] 🔄 Tentando endpoints alternativos...
[INTER] 🔄 Testando endpoints alternativos para PDF...
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/pdf/download
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/pdf/download
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:51:13 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-24/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-24/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 24: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 24
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: a8599139-cfc4-4ea3-abda-b08d9836441a
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: a8599139-cfc4-4ea3-abda-b08d9836441a
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/a8599139-cfc4-4ea3-abda-b08d9836441a
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/pdf/download: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/pdf/download falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/arquivo
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/arquivo
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:13 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-f26aa34343d1c57fb8fcf7187c193360-9f45d5cc67b92627-00',
  'x-envoy-upstream-service-time': '83',
  'x-rate-limit-remaining': '117',
  'x-rate-limit-time': '1755089492509',
  'x-upstream-time': '108'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "a8599139-cfc4-4ea3-abda-b08d9836441a",
    "seuNumero": "SX87199-24",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-08-02",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348295",
    "codigoBarras": "07793189100000833330001112134234790398348295",
    "linhaDigitavel": "07790001161213423479303983482955318910000083333"
  },
  "pix": {
    "txid": "3464705361755009087000Saqee4iT1OD1Q",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/6b764ddf15c04ec6a7047d09ec62988a5204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***6304C512"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983482955318910000083333
[INTER] 📊 Código de barras: 07793189100000833330001112134234790398348295
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/a8599139-cfc4-4ea3-abda-b08d9836441a/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-24/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-24/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-24/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-24/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/arquivo: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/arquivo falhou
[INTER] 🔄 Tentando: /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/documento
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/documento
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:14 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-29a5f44f5d02ac4ae32a070d3a08944d-eb39ce7625765c46-00',
  'x-envoy-upstream-service-time': '129',
  'x-rate-limit-remaining': '117',
  'x-rate-limit-time': '1755089492747',
  'x-upstream-time': '133',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 55346 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55336 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55336 caracteres
[INTER] ✅ PDF convertido: 41500 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41500 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43447 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 24 adicionada
[SECURE_CONTAINER] 📦 Criando container com 24 PDFs
[SECURE_CONTAINER] 🔄 Usando método Node.js puro
[SECURE_CONTAINER] ✅ Container seguro criado: 1389500 bytes
[SECURE_CONTAINER] 🔑 Senha: doc20250813
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:51:14 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-24/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-24/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 24: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 24
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: a8599139-cfc4-4ea3-abda-b08d9836441a
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: a8599139-cfc4-4ea3-abda-b08d9836441a
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/a8599139-cfc4-4ea3-abda-b08d9836441a
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:51:14 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-24/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-24/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 24: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 24
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: a8599139-cfc4-4ea3-abda-b08d9836441a
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: a8599139-cfc4-4ea3-abda-b08d9836441a
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/a8599139-cfc4-4ea3-abda-b08d9836441a
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ❌ Request error for /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/documento: Error: socket hang up
    at TLSSocket.socketOnEnd (node:_http_client:528:25)
    at TLSSocket.emit (node:events:536:35)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'ECONNRESET'
}
[INTER] ❌ Endpoint /cobranca/v3/cobrancas/CORRETO-1755013508.325368-24/documento falhou
[INTER] 🔄 Tentando: /banking/v2/cobrancas/CORRETO-1755013508.325368-24/pdf
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/banking/v2/cobrancas/CORRETO-1755013508.325368-24/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/pdf, application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 404 Not Found
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'text/plain',
  date: 'Wed, 13 Aug 2025 12:51:14 GMT',
  'content-length': '18'
}
[INTER] 🔍 Response Content-Type: text/plain
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 18 bytes
[INTER] ❌❌❌ ERROR RESPONSE ❌❌❌
[INTER] 🚨 Status Code: 404
[INTER] 🚨 Error Body: "404 page not found"
[INTER] 🚨 Error Body Length: 18 chars
[INTER] 📄 PDF ENDPOINT ERROR ANALYSIS:
[INTER] 📄 Requested endpoint: /banking/v2/cobrancas/CORRETO-1755013508.325368-24/pdf
[INTER] 📄 Accept header sent: application/pdf, application/json
[INTER] 📄 Content-Type received: text/plain
[INTER] 📋 Error is not JSON, raw text: 404 page not found
[INTER] ❌❌❌ END ERROR RESPONSE ❌❌❌
[INTER] ❌ Endpoint /banking/v2/cobrancas/CORRETO-1755013508.325368-24/pdf falhou
[SECURE_CONTAINER] ❌ Erro na parcela 24: Error: Nenhum endpoint funcionou para obter o PDF
    at InterBankService.tentarEndpointsAlternativos (/home/runner/workspace/server/services/interBankService.ts:1030:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes/inter-collections.ts:529:29)
[SECURE_CONTAINER] 📄 Baixando parcela 24
[INTER] 📄 SOLUÇÃO IDENTIFICADA: API v3 retorna PDF como base64 em JSON
[INTER] 🔍 Processando codigoSolicitacao: a8599139-cfc4-4ea3-abda-b08d9836441a
[INTER] 🔍 STEP 1: Verificando se cobrança existe...
[INTER] 📋 Retrieving collection: a8599139-cfc4-4ea3-abda-b08d9836441a
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/a8599139-cfc4-4ea3-abda-b08d9836441a
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:14 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-eb4e8b237fc2da8f2a201ed3277d9b39-67254d27dfaee0f9-00',
  'x-envoy-upstream-service-time': '53',
  'x-rate-limit-remaining': '116',
  'x-rate-limit-time': '1755089492509',
  'x-upstream-time': '55'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "a8599139-cfc4-4ea3-abda-b08d9836441a",
    "seuNumero": "SX87199-24",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-08-02",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348295",
    "codigoBarras": "07793189100000833330001112134234790398348295",
    "linhaDigitavel": "07790001161213423479303983482955318910000083333"
  },
  "pix": {
    "txid": "3464705361755009087000Saqee4iT1OD1Q",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/6b764ddf15c04ec6a7047d09ec62988a5204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***6304C512"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983482955318910000083333
[INTER] 📊 Código de barras: 07793189100000833330001112134234790398348295
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/a8599139-cfc4-4ea3-abda-b08d9836441a/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:14 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-19d267f5ef494e8428540fa636357097-fc698e7409e7d054-00',
  'x-envoy-upstream-service-time': '67',
  'x-rate-limit-remaining': '115',
  'x-rate-limit-time': '1755089492509',
  'x-upstream-time': '70'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "a8599139-cfc4-4ea3-abda-b08d9836441a",
    "seuNumero": "SX87199-24",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-08-02",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348295",
    "codigoBarras": "07793189100000833330001112134234790398348295",
    "linhaDigitavel": "07790001161213423479303983482955318910000083333"
  },
  "pix": {
    "txid": "3464705361755009087000Saqee4iT1OD1Q",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/6b764ddf15c04ec6a7047d09ec62988a5204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***6304C512"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983482955318910000083333
[INTER] 📊 Código de barras: 07793189100000833330001112134234790398348295
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/a8599139-cfc4-4ea3-abda-b08d9836441a/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-length': '975',
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:14 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-dd5b5b0b29e95b637cf17f980b09b7e9-7aaef7c8a1fa623e-00',
  'x-envoy-upstream-service-time': '105',
  'x-rate-limit-remaining': '114',
  'x-rate-limit-time': '1755089492509',
  'x-upstream-time': '107'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 975 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Collection data: {
  "cobranca": {
    "codigoSolicitacao": "a8599139-cfc4-4ea3-abda-b08d9836441a",
    "seuNumero": "SX87199-24",
    "dataEmissao": "2025-08-12",
    "dataVencimento": "2027-08-02",
    "valorNominal": 833.33,
    "tipoCobranca": "SIMPLES",
    "situacao": "A_RECEBER",
    "dataSituacao": "2025-08-12",
    "arquivada": false,
    "descontos": [],
    "pagador": {
      "cpfCnpj": "20528464760",
      "tipoPessoa": "FISICA",
      "nome": "GABRIEL DE JESUS SANTANA SERRI",
      "endereco": "RUA MIGUEL ANGELO",
      "bairro": "CENTRO",
      "cidade": "SERRA",
      "uf": "ES",
      "cep": "29165460",
      "email": "",
      "ddd": "",
      "telefone": "",
      "numero": "100",
      "complemento": ""
    }
  },
  "boleto": {
    "nossoNumero": "90398348295",
    "codigoBarras": "07793189100000833330001112134234790398348295",
    "linhaDigitavel": "07790001161213423479303983482955318910000083333"
  },
  "pix": {
    "txid": "3464705361755009087000Saqee4iT1OD1Q",
    "pixCopiaECola": "00020101021226980014BR.GOV.BCB.PIX2576spi-qrcode.bancointer.com.br/spi/pj/v2/cobv/6b764ddf15c04ec6a7047d09ec62988a5204000053039865406833.335802BR5901*6007VITORIA61082901819062070503***6304C512"
  }
}
[INTER] ⚠️ QR Code generation not implemented yet
[INTER] ✅ Collection retrieved and enriched successfully
[INTER] 📊 Linha digitável: 07790001161213423479303983482955318910000083333
[INTER] 📊 Código de barras: 07793189100000833330001112134234790398348295
[INTER] 📊 PIX disponível: Sim
[INTER] ✅ Cobrança existe, prosseguindo para PDF...
[INTER] 🔍 STEP 2: Buscando PDF (esperando JSON com base64)...
[INTER] ========== REQUEST DETAILS ==========
[INTER] 🌐 FULL URL: https://cdpj.partners.bancointer.com.br/cobranca/v3/cobrancas/a8599139-cfc4-4ea3-abda-b08d9836441a/pdf
[INTER] 🔧 METHOD: GET
[INTER] 🪙 TOKEN (first 20 chars):', d7657875-1c04-493e-8...
[INTER] ===================================
[INTER] 📋 Certificate is single-line PEM, adding line breaks...
[INTER] 🔑 Private key is single-line PEM, adding line breaks...
[INTER] 🏦 CONTA CORRENTE HEADER ADDED: 346470536
[INTER] 🔑 ALL HEADERS: {
  "Authorization": "Bearer d7657875-1c04-493e-8a7e-5481330c9720",
  "Accept": "application/json",
  "User-Agent": "SIMPIX-Inter-Integration/1.0",
  "Content-Type": "application/json",
  "x-conta-corrente": "346470536"
}
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:14 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-fbeea18a36ffaf244e8ca590dfb189f9-24f53b7693c11fab-00',
  'x-envoy-upstream-service-time': '126',
  'x-rate-limit-remaining': '116',
  'x-rate-limit-time': '1755089492747',
  'x-upstream-time': '129',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:14 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-f60f669fcf6b01198caa276d9c6e5007-0cf20de73c2c069e-00',
  'x-envoy-upstream-service-time': '142',
  'x-rate-limit-remaining': '115',
  'x-rate-limit-time': '1755089492747',
  'x-upstream-time': '143',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] ========== RESPONSE DETAILS ==========
[INTER] 📊 STATUS: 200 OK
[INTER] 📋 RESPONSE HEADERS: {
  'content-type': 'application/json',
  date: 'Wed, 13 Aug 2025 12:51:15 GMT',
  server: 'istio-envoy',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  traceparent: '00-85fbc43eabbeee5d51fc7563afaaf447-6ceb39d636c20bcc-00',
  'x-envoy-upstream-service-time': '149',
  'x-rate-limit-remaining': '114',
  'x-rate-limit-time': '1755089492747',
  'x-upstream-time': '151',
  'transfer-encoding': 'chunked'
}
[INTER] 🔍 Response Content-Type: application/json
[INTER] 🔍 Is PDF Response: false
[INTER] 📦 Response buffer size: 55346 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55336 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55336 caracteres
[INTER] ✅ PDF convertido: 41500 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41500 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43447 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 24 adicionada
[SECURE_CONTAINER] 📦 Criando container com 24 PDFs
[SECURE_CONTAINER] 🔄 Usando método Node.js puro
[SECURE_CONTAINER] ✅ Container seguro criado: 1389516 bytes
[SECURE_CONTAINER] 🔑 Senha: doc20250813
[INTER] 📦 Response buffer size: 55346 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55336 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55336 caracteres
[INTER] ✅ PDF convertido: 41500 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41500 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43440 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 24 adicionada
[SECURE_CONTAINER] 📦 Criando container com 24 PDFs
[SECURE_CONTAINER] 🔄 Usando método Node.js puro
[SECURE_CONTAINER] ✅ Container seguro criado: 1389548 bytes
[SECURE_CONTAINER] 🔑 Senha: doc20250813
[INTER] 📦 Response buffer size: 55346 bytes
[INTER] ✅ Response OK
[INTER] =====================================
[INTER] 📊 Tipo de resposta: object
[INTER] 📋 Resposta é JSON, procurando campo base64...
[INTER] 📋 Campos disponíveis no JSON: [ 'pdf' ]
[INTER] ✅ Campo 'pdf' encontrado com 55336 caracteres
[INTER] ✅ Base64 encontrado no campo 'pdf'
[INTER] 📊 Tamanho do base64: 55336 caracteres
[INTER] ✅ PDF convertido: 41500 bytes
[INTER] ✅ PDF VÁLIDO CONFIRMADO! Magic bytes: %PDF-
[PDF_SANITIZER] 🚨 INICIANDO SANITIZAÇÃO EXTREMAMENTE AGRESSIVA
[PDF_SANITIZER] Tamanho original: 41500 bytes
[PDF_SANITIZER] ✓ Metadados básicos sanitizados
[PDF_SANITIZER] ✓ Assinatura governamental adicionada
[PDF_SANITIZER] ✓ Marcas d'água invisíveis aplicadas
[PDF_SANITIZER] 🔥 Reconstrução agressiva iniciada
[PDF_SANITIZER] ✓ PDF reconstruído agressivamente
[PDF_SANITIZER] 🛡️ Adicionando headers de segurança máximos
[PDF_SANITIZER] ✓ Headers de segurança máximos aplicados
[PDF_SANITIZER] 🎯 Quebrando heurística específica do McAfee
[PDF_SANITIZER] ✓ Heurística do McAfee quebrada
[PDF_SANITIZER] Tamanho final: 43445 bytes
[PDF_SANITIZER] ✅ SANITIZAÇÃO EXTREMAMENTE AGRESSIVA CONCLUÍDA
[SECURE_CONTAINER] ✅ Parcela 24 adicionada
[SECURE_CONTAINER] 📦 Criando container com 24 PDFs
[SECURE_CONTAINER] 🔄 Usando método Node.js puro
[SECURE_CONTAINER] ✅ Container seguro criado: 1389528 bytes
[SECURE_CONTAINER] 🔑 Senha: doc20250813