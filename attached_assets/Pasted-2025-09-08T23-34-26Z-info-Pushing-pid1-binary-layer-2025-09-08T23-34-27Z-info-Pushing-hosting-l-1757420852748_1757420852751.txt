2025-09-08T23:34:26Z info: Pushing pid1 binary layer...
2025-09-08T23:34:27Z info: Pushing hosting layer...
2025-09-08T23:34:27Z info: Pushing Repl layer...
2025-09-08T23:34:27Z info: Retrieved cached nix layer
2025-09-08T23:34:28Z info: Created hosting layer
2025-09-08T23:34:28Z info: Created pid1 binary layer
2025-09-08T23:36:00Z info: Created Repl layer
2025-09-08T23:36:03Z info: Pushed image manifest
2025-09-08T23:36:04Z info: Pushed soci index manifest
2025-09-08T23:36:07Z info: Creating Autoscale service
forwarding local port 5000 to external port 80 (mapped as 1104)
starting up user application
> rest-express@1.0.0 start
> NODE_ENV=production node dist/index.js
{"environment":"production","level":"info","message":"Dead-Letter Queue Manager initialized","service":"simpix-api","timestamp":"2025-09-08 23:37:00","version":"1.0.0"}
[CLICKSIGN V1] API URL: https://app.clicksign.com/api/v1
[CLICKSIGN V1] Token configured: b73b3b90-c87...
11:37:01 PM [express] 🔒 [SECURITY] URL token validation middleware activated - ASVS V7.1.1
11:37:00 PM [express] ⚠️  Missing optional secrets: SUPABASE_URL, SUPABASE_ANON_KEY, SUPABASE_SERVICE_ROLE_KEY, CLICKSIGN_API_KEY
{"environment":"production","level":"info","message":"📊 BullMQ MetricsService module loaded","service":"simpix-api","timestamp":"2025-09-08 23:37:00","version":"1.0.0"}
[CLICKSIGN V1] 🚀 Initialized in PRODUCTION mode (legal signatures)
✅ Database: Configuring Supabase connection...
[CLICKSIGN V1] API URL: https://app.clicksign.com/api/v1
✅ Database: Connection pool configured with 20 max connections (Mission 3 optimization)
[DEV QUEUE] 📦 Created development queue: pdf-processing
11:37:01 PM [express] 🔒 [SECURITY] CORS protection configured - ASVS V13.2.1
📊 Pool Config: idle_timeout=30s, connect_timeout=10s, prepared_statements=disabled
[DEV QUEUE] 📦 Created development queue: boleto-sync
[DEV QUEUE] 📦 Created development queue: notifications
[CLICKSIGN] 🔴 Circuit Breaker will be initialized on first use
[REDIS MANAGER] 🚀 Cliente Redis pronto
[CLICKSIGN V1] 🚀 Initialized in PRODUCTION mode (legal signatures)
[DEV QUEUE] 📦 Created development queue: document-processing
11:37:01 PM [express] 🔒 [SECURITY] Input sanitization middleware activated
11:37:01 PM [express] 🔒 [SECURITY] CSRF protection middleware activated - OWASP Cheat Sheet
[INTER] 🔴 Circuit Breakers will be initialized on first use
{"dsn":"https://7018ab54dbb8...","environment":"production","level":"info","message":"✅ Sentry initialized successfully","service":"simpix-api","timestamp":"2025-09-08 23:37:00","version":"1.0.0"}
[CLICKSIGN V1] Token configured: b73b3b90-c...
11:37:00 PM [express] ✅ IoC Container initialized successfully
11:37:01 PM [express] 🔒 [SECURITY] OPTIONS preflight handling configured
[INTER] 🌐 API URL: https://cdpj.partners.bancointer.com.br
11:37:01 PM [express] 🔒 [SECURITY] Enhanced security headers and strict CSP activated
[QUEUE] 🚀 Job queues initialized with DLQ support
11:37:00 PM [express] 🏗️ Initializing IoC Container...
[DEV QUEUE] 🚀 Development queues initialized with REAL worker processing
{"environment":"production","level":"info","logging":true,"message":"📊 Observability layer initialized","sentry":true,"service":"simpix-api","timestamp":"2025-09-08 23:37:00","version":"1.0.0"}
11:37:01 PM [express]   - Port: 5000
[CCB SYNC] ℹ️ Primary processing via webhooks, polling is safety net only
11:37:01 PM [express] 🎯 Specialized queue workers configured for lazy initialization
11:37:01 PM [express] 🔔 Sistema de Alertas Proativos inicializado - Próxima execução: 09/09/2025, 04:00:00
[REDIS MANAGER] 🎯 Singleton Redis conectado com sucesso
{"environment":"production","level":"info","message":"📊 [FormalizationWorker] BullMQ Worker connected - async processing enabled","service":"simpix-api","timestamp":"2025-09-08 23:37:01","version":"1.0.0"}
[CCB SYNC] 🚀 Starting fallback polling (every 6 hours)
[INTER] 🏦 Initialized in production mode
🚀 [TIMING MIDDLEWARE] Middleware instance created and exported
11:37:01 PM [express] 📦 Checking storage buckets...
11:37:01 PM [express] 🌍 Environment: production
11:37:01 PM [express]   - Security: Rate Limit ✅, Helmet ✅
[Sentry] express is not instrumented. Please make sure to initialize Sentry in a separate file that you `--import` when running node, see: https://docs.sentry.io/platforms/javascript/guides/express/install/esm/.
🚀 [TIMING MIDDLEWARE] Creating middleware instance...
[REDIS MANAGER] 📡 Modo produção: conexão sem TLS (padrão seguro)
{"environment":"production","latency":598,"level":"info","message":"✅ Conexão com Redis Cloud estabelecida com sucesso","service":"redis-cloud","timestamp":"2025-09-08 23:37:01","version":"1.0.0"}
11:37:01 PM [express] 🔐 Security WebSocket initialized
11:37:01 PM [express]   - Environment: production
[REDIS MANAGER] ✅ Conexão TCP estabelecida
11:37:01 PM [express]   - Supabase: ❌ Not configured
🔌 [Security WS] Event listeners configurados (aguardando implementação de EventEmitter nos scanners)
11:37:01 PM [express] 🚀 Server running on port 5000
11:37:01 PM [express] ✅ Storage bucket "documents" already exists as PRIVATE
{"environment":"production","level":"info","message":"📊 MetricsService initialized with Sentry integration","service":"simpix-api","timestamp":"2025-09-08 23:37:00","version":"1.0.0"}
{"environment":"production","level":"warn","message":"⚠️ [FormalizationWorker] Start called but Queue unavailable - no async processing","service":"simpix-api","timestamp":"2025-09-08 23:37:01","version":"1.0.0"}
{"endpoints":["/api/health","/api/health/live","/api/health/ready"],"environment":"production","level":"info","message":"🏥 Health check endpoints registered","service":"simpix-api","timestamp":"2025-09-08 23:37:01","version":"1.0.0"}
11:37:01 PM [express] ⚡ Formalization Worker initialized - Processing async events
11:37:01 PM [express] 🔒 [PROD] Rate limiting configurado para produção - limites seguros
11:37:01 PM [express] 🔧 App Config Status:
11:37:01 PM [express]   - Database: ✅ Connected
IMPORTANT! Eviction policy is volatile-lru. It should be "noeviction"
11:37:01 PM [express] 🔄 CCB Sync Service initialized - Webhook primary, polling fallback every 6 hours
11:37:01 PM [express] ℹ️  Security monitoring disabled. Set ENABLE_SECURITY_MONITORING=true to enable
IMPORTANT! Eviction policy is volatile-lru. It should be "noeviction"
11:37:01 PM [express]    - Workers will start when first job is processed (on-demand)
[SEMGREP MCP] Connected to Redis via Redis Manager
    at Timeout._onTimeout (/home/runner/workspace/node_modules/ioredis/built/Command.js:192:33)
✅ Database: Connection pool test successful
    at process.processTimers (node:internal/timers:519:7)
    at process.processTimers (node:internal/timers:519:7)
    at listOnTimeout (node:internal/timers:581:17)
Error: Command timed out
{"correlationId":"a62c30ab-c8d5-4d59-8770-83426c99dacf","environment":"production","ip":"127.0.0.1","level":"info","message":"📥 Request received","method":"GET","path":"/","query":{},"service":"simpix-api","timestamp":"2025-09-08 23:37:02","url":"/","userAgent":"Go-http-client/1.1","version":"1.0.0"}
    at Timeout._onTimeout (/home/runner/workspace/node_modules/ioredis/built/Command.js:192:33)
📊 Connection latency: 1441ms
    at listOnTimeout (node:internal/timers:581:17)
Error: Command timed out
🔧 Connection pool ready for high concurrency workload
2025-09-08T23:37:10Z info: Waiting for service to be ready
Error: Command timed out
    at Timeout._onTimeout (/home/runner/workspace/node_modules/ioredis/built/Command.js:192:33)
    at Timeout._onTimeout (/home/runner/workspace/node_modules/ioredis/built/Command.js:192:33)
    at process.processTimers (node:internal/timers:519:7)
    at listOnTimeout (node:internal/timers:581:17)
Error: Command timed out
    at listOnTimeout (node:internal/timers:581:17)
    at process.processTimers (node:internal/timers:519:7)
2025-09-08T23:37:13Z info: Deployment successful