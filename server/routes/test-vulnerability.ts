// ARQUIVO DE TESTE - RED TEAM VALIDATION
// Este arquivo contém vulnerabilidades propositais para testar o Semgrep

import express from 'express';

const router = express.Router();

// VULNERABILIDADE 1: Senha hardcoded (deve ser detectada pelo Semgrep)
const superSecretKey = 'password123';
const apiKey = 'sk-1234567890abcdef';

// VULNERABILIDADE 2: SQL Injection potencial
router.get('/vulnerable', (req, res) => {
  const query = `SELECT * FROM users WHERE id = ${req.query.id}`;
  // Esta linha deve ser detectada como SQL injection vulnerability
});

// VULNERABILIDADE 3: XSS potencial
router.post('/unsafe', (req, res) => {
  const userInput = req.body.message;
  res.send(`<div>${userInput}</div>`); // Sem sanitização
});

// VULNERABILIDADE 4: Informações sensíveis em logs
console.log(`Database password: admin123`);
console.log(`Credit card: 4532-1234-5678-9012`);

export default router;