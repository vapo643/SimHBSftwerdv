### Pacote de Ativação de Missão (PAM) V1.0 (Correção de Módulos de Teste)

* **Sumário da Missão (O Quê):** Corrigir os problemas de `import` e `export` entre o serviço `statusFsmService.ts` e sua suíte de testes unitários `status-fsm.test.ts`.
* **Intenção Estratégica (O Porquê):** Executar a correção de maior impacto e menor esforço. A resolução destes problemas estruturais irá restaurar imediatamente 10 dos 20 testes falhos, representando um avanço de 50% na nossa missão de estabilização da suíte de testes.
* **Histórico Relevante (Consulta Obrigatória):** O seu relatório de diagnóstico (Missão 1.1a) identificou que `status-fsm.test.ts` está a importar o `ProposalStatus` enum do local errado e a tentar usar funções (`validateTransition`, `getPossibleTransitions`) que não estão a ser exportadas de `statusFsmService.ts`.
* **Modelo Mental (Como se Encaixa):** Esta é uma refatoração de interface de módulo. Estamos a expor (exportar) as funções necessárias do nosso serviço FSM e a corrigir o consumidor (o teste) para que ele as encontre no local correto.
* **Riscos Antecipados e Contramedidas:**
    * **Risco:** A alteração de `exports` pode ter efeitos colaterais em outras partes do sistema que usam o serviço.
    * **Contramedida:** Uma busca global por usos das funções a serem exportadas será feita para garantir que a mudança é segura. O risco é baixo, pois o diagnóstico indicou que estas funções não estão a ser usadas em outro lugar.

---

**IMPLEMENTAR:**
Correção de Módulos de Teste da FSM

**CURRENT STATE:**
O arquivo `tests/unit/status-fsm.test.ts` contém erros de importação que causam 10 falhas de teste. O `statusFsmService.ts` não exporta todas as funções necessárias para os seus testes unitários.

**EXPECTED (Estado Final de Sucesso):**
1.  O arquivo `server/services/statusFsmService.ts` é modificado para exportar as funções `validateTransition` e `getPossibleTransitions`. (O `enum ProposalStatus` já está corretamente exportado).
2.  O arquivo `tests/unit/status-fsm.test.ts` é modificado para remover a importação incorreta de `@shared/schema` e importar `ProposalStatus`, `validateTransition` e `getPossibleTransitions` do caminho correto: `../../server/services/statusFsmService`.
3.  **O critério de sucesso final e não negociável:** A execução do comando `npx vitest run tests/unit/status-fsm.test.ts` resulta em **TODOS os testes deste arquivo passando com sucesso**.

**CONSTRAINTS (Roadmap de Implementação):**
1.  **Modifique o Serviço Primeiro:** Abra `server/services/statusFsmService.ts`. Adicione a palavra-chave `export` na frente das definições das funções `validateTransition` e `getPossibleTransitions`.
2.  **Corrija o Teste:** Abra `tests/unit/status-fsm.test.ts`. Localize a linha de importação `import { ProposalStatus } from "@shared/schema";` e substitua-a pela importação correta e completa: `import { ProposalStatus, validateTransition, getPossibleTransitions } from '../../server/services/statusFsmService';`.
3.  **Validação Final Mandatória:** Execute a suíte de testes específica para este arquivo: `npx vitest run tests/unit/status-fsm.test.ts`. Inclua o output bem-sucedido que mostra os testes a passar no seu relatório final como prova de sucesso.

---
**DECLARAÇÃO DE INCERTEZA (OBRIGATÓRIO):**
* **CONFIANÇA NA IMPLEMENTAÇÃO:** [Preencher com a porcentagem de 0 a 100%]
* **RISCOS IDENTIFICADOS:** [Preencher com a categoria BAIXO/MÉDIO/ALTO/CRÍTICO]
* **DECISÕES TÉCNICAS ASSUMIDAS:** [Ex: "Assumi que exportar estas funções não terá impacto noutras partes da aplicação, conforme o diagnóstico."]
* **VALIDAÇÃO PENDENTE:** [Nenhuma. O sucesso é definido pela passagem de 100% dos testes no arquivo alvo.]
---

**PROTOCOLO OBRIGATÓRIO 7-CHECK EXPANDIDO:**
1.  Mapear ficheiros e funções exatas afetadas.
2.  Garantir que os `exports` e `imports` estão sintaticamente corretos.
3.  Executar `get_latest_lsp_diagnostics` para garantir 0 erros novos.
4.  **Declarar Nível de Confiança (0 a 100%)**.
5.  **Categorizar Riscos Descobertos**.
6.  **Realizar teste funcional completo** (executar a suíte de testes `status-fsm.test.ts` e garantir que todos passem).
7.  **Documentar Decisões Técnicas**.