# MISSÃO: Auditoria Mestra de Integração com o Supabase

**CONTEXTO:** Após múltiplas falhas de conexão e a descoberta de que o `Agente de IA` estava a utilizar um banco de dados local, precisamos de uma auditoria completa e definitiva para garantir que o nosso projeto Replit está 100% conectado e a utilizar a nossa instância oficial do Supabase.

**AÇÃO:** A sua tarefa como consultor técnico é realizar uma auditoria de 3 camadas e fornecer um relatório detalhado.

---
**CAMADA 1: AUDITORIA DE CREDENCIAIS (SECRETS)**

1.  **Verifique os "Secrets":** Analise as variáveis de ambiente no Replit Secrets. As credenciais essenciais do Supabase (`DATABASE_URL`, `SUPABASE_URL`, `SUPABASE_ANON_KEY`, `SUPABASE_SERVICE_ROLE_KEY`) estão presentes e corretamente configuradas?

**RELATÓRIO - CAMADA 1:** As credenciais necessárias para a conexão com o Supabase estão presentes e corretamente configuradas nos "Secrets"? (SIM/NÃO)

---
**CAMADA 2: AUDITORIA DE INTEGRAÇÃO NO CÓDIGO**

1.  **Verifique o Código de Conexão (Backend):** Analise os ficheiros (`server/lib/supabase.ts`, `server/storage.ts`, `drizzle.config.ts`). Eles estão a ler as credenciais a partir dos "Secrets" (`process.env`) para estabelecer a conexão?
2.  **Verifique o Código de Conexão (Frontend):** Analise o ficheiro (`client/src/lib/supabase.ts`). Ele está a utilizar as variáveis `VITE_` corretas para a conexão do lado do cliente?

**RELATÓRIO - CAMADA 2:** O código da aplicação está a utilizar as credenciais dos "Secrets" para se conectar ao Supabase? (SIM/NÃO)

---
**CAMADA 3: AUDITORIA DO BANCO DE DADOS REAL**

1.  **Execute uma Consulta de Verificação:** Utilizando as credenciais do projeto, conecte-se ao banco de dados e liste todas as tabelas existentes no schema 'public'.
2.  **Compare com o Nosso Schema:** Compare a lista de tabelas que você encontrou com a lista de tabelas que deveriam existir no nosso projeto (`parceiros`, `lojas`, `produtos`, `tabelas_comerciais`, `profiles`, `propostas`, `proposta_logs`, `parcelas`, `gerente_lojas`).

**RELATÓRIO - CAMADA 3:** O banco de dados ao qual a aplicação está conectada contém todas as 9 tabelas do nosso schema? (SIM/NÃO)

---
**VEREDITO FINAL:** Com base na sua análise completa, a integração com o Supabase está 100% correta e funcional?