# MISSÃO DE FINALIZAÇÃO: Restaurar a Funcionalidade Completa da Tela "Nova Proposta" (T-01)

**Contexto:** Olá, Agente. O seu último trabalho para conectar a tela de "Nova Proposta" foi um sucesso estratégico! A tela agora carrega os dados reais do nosso endpoint orquestrador, o que é um avanço imenso. No entanto, esta nova implementação quebrou duas funcionalidades essenciais que precisamos que você restaure.

**Lista de Bugs a Corrigir:**

* **1. A Simulação em Tempo Real parou de Funcionar:**
    * **O Problema (Sintoma):** Antes, na aba "Condições do Empréstimo", quando o usuário alterava o valor, o prazo ou a tabela, a área de "Resumo da Simulação" atualizava-se em tempo real. Agora, esta funcionalidade está quebrada e a simulação não acontece.
    * **Sua Tarefa:** Re-implemente a lógica de simulação em tempo real. O sistema deve observar as mudanças nos campos de condições do empréstimo e, a cada mudança, fazer uma chamada automática à nossa API `POST /api/simular`, atualizando a área de resumo com os novos valores da parcela, CET, etc.

* **2. O Envio da Proposta está a Falhar:**
    * **O Problema (Sintoma):** Após preencher todos os campos do formulário em todas as abas, ao clicar em "Enviar Proposta", a API retorna um erro de **"invalid data"** ou "erro ao criar proposta".
    * **O Diagnóstico Provável:** A estrutura do objeto de dados que o nosso novo frontend (com o `ProposalContext`) está a enviar para a API `POST /api/propostas` não corresponde exatamente ao que o schema de validação Zod no backend espera.
    * **Sua Tarefa:** Audite a `mutationFn` de submissão da proposta no frontend. Garanta que o objeto de dados enviado no `body` da requisição `POST /api/propostas` seja **perfeitamente alinhado** com o schema de Drizzle e Zod que temos no backend para a tabela `propostas`.

* **3. (Bónus) Conectar a Tela de Formalização:**
    * **O Problema:** A nossa tela de "Formalização" (T-04) ainda está a usar dados fictícios.
    * **Sua Tarefa:** Já que estamos a trabalhar no fluxo de propostas, por favor, refatore a tela de "Formalização" para que ela chame a API de backend (provavelmente `GET /api/formalizacao/propostas`) e exiba a lista de propostas reais que estão nesta fase do processo.

**Resumo da Missão:**
Faça a simulação em tempo real voltar a funcionar, corrija o erro de submissão do formulário principal e, por fim, conecte a tela de formalização aos dados reais.